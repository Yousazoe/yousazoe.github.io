<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="mask-icon" href="/images/favicon.ico" color="#222"><meta name="google-site-verification" content="35AYyqm-wpmGmXtkn-vQMrk7AkFl1Do55uHdlLLLT38"><meta name="baidu-site-verification" content="slBbq5f8WxljPytW"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/5.15.4/css/all.min.css"><link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//unpkg.com/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//unpkg.com/pace-js@1.2.4/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"yousazoe.top",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!0,comments:{style:"tabs",active:null,storage:!0,lazyload:!0,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:3,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="引言这一节课面向已经有一些 C++ 基础的同学(一个快速判断标准:是否知道构造函数和析构函数是什么，并自己写过构造函数和析构函数)， 复习串讲一些 OOP 中的知识点，以及介绍一些有趣的在面试中或者在写程序时用得到的 C++ 知识。"><meta property="og:type" content="article"><meta property="og:title" content="C++梳理"><meta property="og:url" content="https://yousazoe.top/archives/74ba873d.html"><meta property="og:site_name" content="Fl0w3r"><meta property="og:description" content="引言这一节课面向已经有一些 C++ 基础的同学(一个快速判断标准:是否知道构造函数和析构函数是什么，并自己写过构造函数和析构函数)， 复习串讲一些 OOP 中的知识点，以及介绍一些有趣的在面试中或者在写程序时用得到的 C++ 知识。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/AhZ5WD.jpg"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(3).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(7).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(8).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(10).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(11).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(12).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(13).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(14).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(15).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(16).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(17).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(18).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(19).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(20).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(21).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(22).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(23).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(24).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(25).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(26).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(27).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(28).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(29).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(30).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(31).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(32).PNG"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(33).PNG"><meta property="article:published_time" content="2022-09-12T12:09:10.000Z"><meta property="article:modified_time" content="2023-07-09T15:27:04.508Z"><meta property="article:author" content="Yousazoe"><meta property="article:tag" content="Cpp"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.yousazoe.top/uPic/img/blog/THUAA1/AhZ5WD.jpg"><link rel="canonical" href="https://yousazoe.top/archives/74ba873d.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>C++梳理 | Fl0w3r</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Fl0w3r" type="application/atom+xml"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Fl0w3r</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">carpe diem</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-address-card fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-paperclip fa-fw"></i>Links</a></li><li class="menu-item menu-item-photos"><a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>Photos</a></li><li class="menu-item menu-item-artitalk"><a href="/artitalk/" rel="section"><i class="fa fa-calendar fa-fw"></i>Artitalk</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-document"><a href="/docs/" rel="section"><i class="fas fa-book fa-fw"></i>Document</a></li><li class="menu-item menu-item-qexoadmin"><a href="https://blog-yousazoe-qexo.vercel.app/" rel="noopener" target="_blank"><i class="fa fa-database fa-fw"></i>QexoAdmin</a></li><li class="menu-item menu-item-gametracker"><a href="https://yousazoe.notion.site/yousazoe/b05999823bd14b57a7a6cd81fba1a1af?v=21c3398e0bdb429c9b8157b7bf12ff6a" rel="noopener" target="_blank"><i class="fas fa-trophy fa-fw"></i>GameTracker</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://yousazoe.top/archives/74ba873d.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><meta itemprop="name" content="Yousazoe"><meta itemprop="description" content="done is better than perfect"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Fl0w3r"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">C++梳理</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-09-12 20:09:10" itemprop="dateCreated datePublished" datetime="2022-09-12T20:09:10+08:00">2022-09-12</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E7%AE%97%E6%B3%95%E5%8D%8F%E4%BC%9A-Tsinghua-University-Algorithm-Association/" itemprop="url" rel="index"><span itemprop="name">清华大学算法协会 (Tsinghua University Algorithm Association)</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="fas fa-pen"></i></span><span>5.9k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span>11 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><p><a target="_blank" rel="noopener" href="https://www.behance.net/gallery/132894291/The-Lovers?tracking_source=search_projects%7Clow%20poly"><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/AhZ5WD.jpg"></a></p><h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p>这一节课面向已经有一些 C++ 基础的同学(一个快速判断标准:是否知道构造函数和析构函数是什么，并自己写过构造函数和析构函数)， 复习串讲一些 OOP 中的知识点，以及介绍一些有趣的在面试中或者在写程序时用得到的 C++ 知识。</p><span id="more"></span><iframe src="//player.bilibili.com/player.html?aid=386482748&amp;bvid=BV15d4y1U7HH&amp;cid=787484737&amp;page=1&amp;high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen=""></iframe><br><h3 id="关于算协"><a href="#关于算协" class="headerlink" title="关于算协"></a>关于算协</h3><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(3).PNG"></p><ul><li><p>2016年：清华大学计算机系学生算法与竞赛协会</p><ul><li>举办过的活动：清华校赛（THUPC）</li></ul></li><li><p>2022年：清华大学学生算法协会</p><ul><li>成为校级社团 希望开展更广泛的活动</li></ul></li></ul><p>暑期培训：拓展业务的尝试，希望你在奋斗的路上少一些孤单。</p><ul><li>初衷：帮助大三升大四的同学复习编程和算法知识</li><li>形式：多次相对独立的授课，提供回放</li><li>建议：分析自身需求，有选择性地听课和完成作业</li></ul><h3 id="授课定位"><a href="#授课定位" class="headerlink" title="授课定位"></a>授课定位</h3><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(7).PNG"></p><ul><li>C++ 相当庞大 不仅语言名字的字符数是 C 语言的三倍 标准的长度也相当于C语言的三倍多。</li><li>C++20 标准页数 1853 页</li><li><a target="_blank" rel="noopener" href="https://www.iso.org/standard/79358.html">ISO - ISO/IEC 14882:2020 - Programming languages — C++</a></li><li>C11 标准页数 520 页</li><li><a target="_blank" rel="noopener" href="https://www.iso.org/standard/74528.html">ISO - ISO/IEC 9899:2018 - Information technology — Programming languages — C</a></li><li>段子：21 天才能精通 C++</li><li>本次课理想受众：至少上过一门 C++ 的课程/读过一本 C++ 的入门书籍</li></ul><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(8).PNG"></p><ul><li>尝试带大家梳理一些语言特性，帮助大家“融会贯通”</li><li>最终希望大家能够尝试自己梳理更多的 C++ 语言特性、或用同样的思路学习其他语言。</li><li>第一次做这种尝试，请大家在课后问卷中多多反馈</li><li>You can’t just look at C++ as a collection of features; some features make no sense in isolation. You can only use the sum of the parts if you are thinking about design, not simply coding. And to understand C++ this way, you must understand the problems with C and with programming in general.</li><li>– Bruce Eckel，Thinking in C++</li><li>The C++ Programming Language 里，大量的交叉引用反映了语言特性之间的互动和联系</li></ul><h3 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h3><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(10).PNG"></p><h4 id="内存是什么？"><a href="#内存是什么？" class="headerlink" title="内存是什么？"></a>内存是什么？</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(11).PNG"></p><ul><li>我们可以认为，程序处理的数据存储在内存（RAM）（忽略缓存和硬盘的使用）</li><li>现在常用的内存条，包含若干内存颗粒(半导体集成电路)</li><li>物理上，通过一些微小的元器件来表示 “0” “1” 状态</li><li>能存储的比特数取决于集成电路里的元器件数目</li><li>可以想象成一条非常非常长的纸带 每个格子可以填写 0-255 的一个状态（8 个 0/1 比特，一个字节）</li><li>例如 16G 的内存，一共能填写 16x1024x1024x1024 个字节</li><li>然后这根纸带卷啊卷，卷到了一根内存条这么大</li><li>这就是操作系统所拥有的内存资源，操作系统会将内存分配给正在执行的程序</li></ul><h4 id="内存分配"><a href="#内存分配" class="headerlink" title="内存分配"></a>内存分配</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(12).PNG"></p><ul><li>（分配内存的细节，和编译器、操作系统、运行时环境等等有关，具体细节需具体学习）</li><li>计算机上有多个程序同时运行，操作系统也预留了一部分内存，而内存是有限的</li><li>因此程序只能在操作系统分配给它的范围内使用内存</li><li>操作系统一开始就分配给程序一些内存，用来存储全局变量、局部变量、函数参数返回值、程序代码等数据。其中，全局变量、程序代码分配在static内存区域（从程序开始执行到结束，这些内存都被占用）。局部变量、函数参数返回值等，被分配在栈内存区域（函数调用栈）</li><li>函数每一次被调用时，在函数调用栈中分配一个大小合适的栈帧，存储这一次的局部变量、参数和返回值。从函数中返回时，释放栈帧的内存。（操作系统角度，整个函数调用栈还是在程序那里）</li><li>递归过深程序崩溃，是因为大量的栈帧未释放，占满了函数调用栈的内存。(stack overflow)</li><li>另外，程序在运行时，可以向操作系统动态地申请和释放一些内存（堆内存）</li></ul><h4 id="变量-x2F-指针-x2F-引用"><a href="#变量-x2F-指针-x2F-引用" class="headerlink" title="变量/指针/引用"></a>变量/指针/引用</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(13).PNG"></p><ul><li>变量：一块具有类型的内存（类型：数据的存储表示方式以及你可以对它进行的操作）</li><li>指针：一块内存的地址，指针的类型可能说明这个指针指向特定类型的变量。（void*）</li><li>引用：可以理解为指针的一种“语法糖”（左值引用/右值引用）</li><li>数组：内存中连续排列的多个同类型变量。数组名称可以用作指向第一个元素的指针</li><li>自定义的类型 (class/struct):一组成员变量在内存里的排列方式以及可以对它进行的操作</li><li>一个对象：按照特定排列方式存储在内存里的一组成员变量<br>+（课后练习：查阅资料，复习/学习 struct 中各个成员变量的 layout 规则）</li></ul><h4 id="一些类的示例"><a href="#一些类的示例" class="headerlink" title="一些类的示例"></a>一些类的示例</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(14).PNG"></p><p><code>Model2</code> 中一目了然的设计缺陷：</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span> {</span><br><span class="line">    <span class="type">double</span> x;</span><br><span class="line">    <span class="type">double</span> y;</span><br><span class="line">    <span class="type">double</span> z;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Triangle</span> {</span><br><span class="line">    Point A;</span><br><span class="line">    Point B;</span><br><span class="line">    Point C;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Model</span> {</span><br><span class="line">    Triangle many_triangles[<span class="number">100</span>];</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Model2</span> {</span><br><span class="line">    Triangle* triangles;</span><br><span class="line">    <span class="built_in">Model2</span>(<span class="type">int</span> n) {</span><br><span class="line">        triangles = <span class="keyword">new</span> Triangle[n];</span><br><span class="line">    }</span><br><span class="line">    ~<span class="built_in">Model2</span>() {</span><br><span class="line">        <span class="keyword">delete</span>[] triangles;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Model3</span> {</span><br><span class="line">    std::vector&lt;Triangle&gt; triangles;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p><code>Model2</code> 需要加一个成员变量表示拥有多少个三角形面片。</p><h4 id="构造函数-x2F-析构函数，new-x2F-delete"><a href="#构造函数-x2F-析构函数，new-x2F-delete" class="headerlink" title="构造函数/析构函数，new/delete"></a>构造函数/析构函数，new/delete</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(15).PNG"></p><ul><li>C++ 中两个运算符替代了C语言的 malloc/dealloc 库函数</li><li>通过 new/delete 动态分配或释放一个对象时会发生:</li><li>new：分配内存，然后调用对应的构造函数(递归调用各个成员变量的构造函数)</li><li>delete：调用对应的析构函数，然后释放内存</li></ul><p>动态内存管理的两种风格(不代表只有这两种风格）</p><ol><li>RAII （C++ 语言中可通过恰当实现构造/析构函数、恰当调用 new/delete 实现）</li><li>垃圾回收（C++ 语言中可通过智能指针实现）</li></ol><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(16).PNG"></p><ul><li>将动态分配的资源的生命周期绑定到某个局部变量上，随着作用域的创建和消失完成分配和释放。</li><li>当希望创建一个动态数组时，不是在主函数里直接 new/delete</li><li>而是使用一个“包含动态数组的类”，作为局部变量定义，构造函数里 new，析构函数里 delete。</li><li>阅读 The C++ programming language 13.3 Resource Managerment，RAII 和异常处理。</li></ul><h4 id="智能指针-amp-垃圾回收"><a href="#智能指针-amp-垃圾回收" class="headerlink" title="智能指针&amp;垃圾回收"></a>智能指针&amp;垃圾回收</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(17).PNG"></p><p>如果计算机能够更加智能，意识到某块动态分配的内存目前没有任何一个活跃的指针会用到，就自动回收这一块内存，会怎么样？</p><p>这里介绍两种垃圾回收思路（并不止两种）：</p><ol><li>引用计数（C++ 中可以用智能指针实现，weak_ptr, shared_ptr, unique_ptr)<br>记录一下当前有多少个活跃的指针指向一块动态分配的内存 当这个计数变为 0 时，释放这块内存。</li><li>Mark &amp; sweep （最早的垃圾回收方法，在Lisp中被使用）<br>每隔一段时间 标记所有从当前程序执行到的位置出发，能够访问到的变量<br>然后将所有未标记的变量释放</li></ol><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(18).PNG"></p><p>时间所限，这里不细讲智能指针的具体语法。</p><p>有空可以看一下 “leak freedom in C++… by default by Herb Sutter”，CppCon的演讲</p><p>思考：</p><ul><li>引用计数和 Mark&amp;Sweep 带来的额外开销有什么区别？注重实时性的系统能否用垃圾回收？</li><li>C++ 中的智能指针常常会重载哪个运算符？(-&gt; 和 *)</li><li>尝试用智能指针实现一个双向链表，要求做到首尾节点释放后，中间的所有节点自动释放</li><li>使用 STL 的容器可以大大方便 C++ 中的一些内存管理，非必要不造轮子</li></ul><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(19).PNG"></p><h4 id="减少函数调用：内联函数-vs-预处理宏"><a href="#减少函数调用：内联函数-vs-预处理宏" class="headerlink" title="减少函数调用：内联函数 vs 预处理宏"></a>减少函数调用：内联函数 vs 预处理宏</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(20).PNG"></p><ul><li><p>调用函数时，处理传参/返回值/栈帧的产生和销毁，会带来一定的开销。</p></li><li><p>对于简单的函数，将调用函数改为直接嵌入一段代码，可以节约一些计算开销。</p></li><li><p>C 语言：采用宏定义， #define min(a, b) ((a&lt;b)?a:b)</p></li><li><p>C++：使用 inline 关键字建议编译器进行内联（但并不代表编译器一定会这么做）</p></li><li><p>C++ 中，建议非必要不使用宏，如果一定要用，起一堆大写字母的丑陋名字</p><br></li><li><p>课后：查询如何用 C++11 中引入的 constexpr 关键字标识函数</p></li></ul><h4 id="传值-x2F-传引用"><a href="#传值-x2F-传引用" class="headerlink" title="传值/传引用"></a>传值/传引用</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(21).PNG"></p><p>定义函数</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">f</span>(Type x){</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>函数 g 内有 Type 类型的局部变量 b，并调用了 f(b)</li><li>在函数 f 内修改 x，会不会导致 f 返回后，函数 g 中 b 的数值发生对应的改变？（传值/传引用）</li><li>f(int x), f(int &amp;x), f(int *x), f(int x[]), f(int &amp;&amp;x)</li></ul><p>思考题：举出一种实际应用情况，我们选择让函数返回一个引用（提示：从The C++ programming language 7.7.1 page 192中查找答案）</p><h4 id="深浅拷贝"><a href="#深浅拷贝" class="headerlink" title="深浅拷贝"></a>深浅拷贝</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(22).PNG"></p><p>拷贝有两种情况可能发生：</p><ul><li>拷贝构造函数</li><li>重载赋值符号(A = B）<br></li><li>当一个类中包含动态分配的资源时，浅拷贝将不会分配第二份资源，使得拷贝后的对象和之前的对象指向相同的一份资源（如数组）。这很多时候是一个 bug，或者可以用 CoW/Move 来替代</li><li>默认的拷贝行为对所有成员函数逐个拷贝</li><li>合理的拷贝行为应当满足：等价性，独立性</li></ul><h4 id="拷贝-x2F-移动"><a href="#拷贝-x2F-移动" class="headerlink" title="拷贝/移动"></a>拷贝/移动</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(23).PNG"></p><p>有时并不需要进行拷贝，因为完成拷贝之后，旧的元素失去了使用的价值。</p><p>例如常见的交换函数：</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(Type a, Type b)</span></span>{</span><br><span class="line">    Type tmp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = tmp;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>可以通过 move 来避免不必要的拷贝。（右值引用表示一个可以被销毁的临时值）</p><h4 id="swap函数"><a href="#swap函数" class="headerlink" title="swap函数"></a>swap函数</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(24).PNG"></p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(Type&amp; A, Type&amp; B)</span> </span>{</span><br><span class="line">    T tmp = std::<span class="built_in">move</span>(a);</span><br><span class="line">    a = std::<span class="built_in">move</span>(b);</span><br><span class="line">    b = std::<span class="built_in">move</span>(tmp);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="函数指针"><a href="#函数指针" class="headerlink" title="函数指针"></a>函数指针</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(25).PNG"></p><ul><li>通过函数指针，实现“以函数为参数”的函数, 或者说，传入一个“谓词”(predicate)</li><li>实质上是函数的代码所在的地址<br></li><li>例如可以定义遍历函数 iterate(数组A，函数B)，对数组中每个元素执行函数B (如都翻倍)</li><li>另一个常见例子：给排序函数传入一个比较函数的函数指针作为参数</li></ul><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp_func</span><span class="params">(<span class="type">const</span> <span class="type">int</span> &amp;a, <span class="type">const</span> <span class="type">int</span> &amp;b)</span></span>{ <span class="keyword">return</span> <span class="built_in">abs</span>(a) &lt; <span class="built_in">abs</span>(b); }</span><br><span class="line">std::<span class="built_in">sort</span>(array_A, array_A+n, cmp_func);</span><br></pre></td></tr></tbody></table></figure><ul><li>另一个用途: 设置回调函数, “发生某事件时调用该函数”</li></ul><h4 id="函数对象"><a href="#函数对象" class="headerlink" title="函数对象"></a>函数对象</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(26).PNG"></p><ul><li>函数对象是重载了函数调用运算符()的对象</li><li>在 C++ 中，应当倾向于使用函数对象 /lambda 表达式而非函数指针</li></ul><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> {</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> <span class="type">const</span> </span>{ <span class="keyword">return</span> a &lt; b; }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><h4 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(27).PNG"></p><ul><li>C++11 标准中引入的匿名函数，用于方便地定义一个匿名的函数对象</li><li>可以在 lambda 中“捕获”当前作用域的变量，定义参数列表，也可以有返回值</li><li>也可以将 lambda 表达式赋值给一个变量</li></ul><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> cmp = (<span class="type">const</span> <span class="type">int</span> &amp;x, <span class="type">const</span> <span class="type">int</span> &amp;y){<span class="keyword">return</span> x&lt;y;}; <span class="comment">//这里没有捕获列表。</span></span><br></pre></td></tr></tbody></table></figure><br>+ 尝试分别用函数指针/函数对象/lambda表达式结合 std::sort( ) 写一个“按照绝对值排序整数的程序” + 查阅文档：如何表示“捕获”一个变量时，捕获它的值/引用？<h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(28).PNG"></p><h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(29).PNG"></p><ul><li>两类典型的继承：“实现继承”/ “接口继承”</li><li>如果没有继承语法，我们如何表示继承关系？</li><li>可以将基类作为子类的一个成员</li><li>如果一开始理解继承机制的时候有困难，可以认为基类就是子类的一种特殊成员变量</li><li>public/private 控制外部对成员变量的访问权限</li><li>通过 protected，特殊控制子类对基类的访问权限</li></ul><p>列个表：</p><ul><li>public/private/protected 继承，子类分别能否访问基类的public/private/protected成员变量？</li></ul><h4 id="虚函数"><a href="#虚函数" class="headerlink" title="虚函数"></a>虚函数</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(30).PNG"></p><ul><li>在成员函数前标注 virtual，允许子类重新实现这个函数，编译器和运行时环境通过虚表，保证调用正确版本的函数</li><li>纯虚函数要求子类必须重新实现这个函数</li><li>虚表可以认为是子类隐藏的一个成员数组，数组中标注每个虚函数具体指向哪一个实现版本（通常是继承关系上，“最近”的一个类所实现的版本，例如如果这个子类自身有实现，就调用自身实现的版本）（虚表中可能会保存指向一些函数实现的函数指针）</li><li>查阅文档: 用 final 或 override 关键字标注一个虚函数，分别会对子类提出什么样的要求？</li></ul><h4 id="运行时多态-runtime-polymorphism"><a href="#运行时多态-runtime-polymorphism" class="headerlink" title="运行时多态(runtime polymorphism)"></a>运行时多态(runtime polymorphism)</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(31).PNG"></p><ul><li>多态: 通过继承和虚函数，可以实现这样的行为: 某个变量的类型为基类的指针，它可以指向某个子类的对象，并正确调用子类对虚函数的具体实现。</li><li>（也可以通过引用来实现多态行为）</li><li>如果不用指针/引用而直接使用一个对象，可能会导致意外的切片(slicing), 从子类转换为基类，丢失了子类的数据。<br></li><li>尝试写一个会导致切片行为的简单程序</li><li>不同语言会用不同的方式来实现多态。查询文档：Java 中如何用 interface 实现多态？(rust 如何用 trait 实现多态？）</li></ul><h4 id="多态的应用：Visitor-pattern"><a href="#多态的应用：Visitor-pattern" class="headerlink" title="多态的应用：Visitor pattern"></a>多态的应用：Visitor pattern</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(32).PNG"></p><ul><li>这是一种在编译器中应用广泛的设计模式</li><li>在编译器中，常常需要多次遍历一个语法树的所有结点，第一轮遍历的时候进行符号收集，第二轮遍历的时候进行代码生成……</li><li>不同类型的节点有着不同的内部结构，但都对外提供构造函数、visit() 等接口</li><li>Visit() 可以接收一个函数对象作为参数，表示对节点进行的操作</li><li>这个函数对象我们称为 visitor，语法树节点的 visit() 接口接收一个基类 visitor 的函数对象作为参数</li><li>实际调用时，传入一个具体的继承 visitor（的指针/引用），对语法树中的节点进行遍历</li><li>如果大家去做一些编译原理课程的作业，看一下实验框架(通常是 toy compiler），或者看一些用 C++ 实现的开源编译器，常常会找到类似的结构。</li></ul><h4 id="模板的简介"><a href="#模板的简介" class="headerlink" title="模板的简介"></a>模板的简介</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/THUAA1/CPPOOP%20(33).PNG"></p><ul><li>函数：对于两段只有参数数值不同的代码，不用重复编写</li><li>模板：对于两个只有参数类型不同的函数，不用重复编写，编译器自动生成程序中用到的不同类型的函数。模板较多的代码往往编译起来非常慢<br></li><li>C++ 的 STL 容器中大量使用了模板，如我们可以定义保存任意类型的 std::vector，定义任意两个类型组成的 std::pair</li><li>可以通过模板来实现一些编译期计算(有个名词叫做“模板元编程”）</li></ul><h4 id="为什么模板类的函数声明和定义要放在一起？"><a href="#为什么模板类的函数声明和定义要放在一起？" class="headerlink" title="为什么模板类的函数声明和定义要放在一起？"></a>为什么模板类的函数声明和定义要放在一起？</h4><p>考虑模板代码生成的过程：</p><ul><li>从编译器的角度，模板函数本身并不是一个能直接拿来链接的函数，而是需要用它来生成一些其他的函数</li><li>将函数声明和定义拆开编写，其实是在链接阶段再去处理函数名称和函数实现的绑定</li><li>链接器通常没有办法在链接阶段再去处理模板参数的替换</li></ul></div><div class="popular-posts-header">Related Posts</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/f1767e7a.html" rel="bookmark">精读 Effective C++</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/c1beecdf.html" rel="bookmark">Infinite Dev Log</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/62e0ea85.html" rel="bookmark">哪些变量会自动初始化？</a></div></li></ul><footer class="post-footer"><div class="post-tags"><a href="/tags/Cpp/" rel="tag"># Cpp</a></div><div class="post-nav"><div class="post-nav-item"><a href="/archives/5bc35f45.html" rel="prev" title="NVIDIA Special Address at SIGGRAPH 2022"><i class="fa fa-chevron-left"></i> NVIDIA Special Address at SIGGRAPH 2022</a></div><div class="post-nav-item"><a href="/archives/558bb9a.html" rel="next" title="STL&amp;基础数据结构">STL&amp;基础数据结构 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:e}=CONFIG.comments;if(CONFIG.comments.storage&&(e=localStorage.getItem("comments_active")||e),e){let t=document.querySelector(`a[href="#comment-${e}"]`);t&&t.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">引言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E7%AE%97%E5%8D%8F"><span class="nav-number">2.</span> <span class="nav-text">关于算协</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%88%E8%AF%BE%E5%AE%9A%E4%BD%8D"><span class="nav-number">3.</span> <span class="nav-text">授课定位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98"><span class="nav-number">4.</span> <span class="nav-text">内存</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">4.1.</span> <span class="nav-text">内存是什么？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D"><span class="nav-number">4.2.</span> <span class="nav-text">内存分配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%98%E9%87%8F-x2F-%E6%8C%87%E9%92%88-x2F-%E5%BC%95%E7%94%A8"><span class="nav-number">4.3.</span> <span class="nav-text">变量/指针/引用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E7%B1%BB%E7%9A%84%E7%A4%BA%E4%BE%8B"><span class="nav-number">4.4.</span> <span class="nav-text">一些类的示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0-x2F-%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%EF%BC%8Cnew-x2F-delete"><span class="nav-number">4.5.</span> <span class="nav-text">构造函数/析构函数，new/delete</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88-amp-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6"><span class="nav-number">4.6.</span> <span class="nav-text">智能指针&amp;垃圾回收</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">5.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%8F%E5%B0%91%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%EF%BC%9A%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0-vs-%E9%A2%84%E5%A4%84%E7%90%86%E5%AE%8F"><span class="nav-number">5.1.</span> <span class="nav-text">减少函数调用：内联函数 vs 预处理宏</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%A0%E5%80%BC-x2F-%E4%BC%A0%E5%BC%95%E7%94%A8"><span class="nav-number">5.2.</span> <span class="nav-text">传值/传引用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="nav-number">5.3.</span> <span class="nav-text">深浅拷贝</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D-x2F-%E7%A7%BB%E5%8A%A8"><span class="nav-number">5.4.</span> <span class="nav-text">拷贝/移动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#swap%E5%87%BD%E6%95%B0"><span class="nav-number">5.5.</span> <span class="nav-text">swap函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88"><span class="nav-number">5.6.</span> <span class="nav-text">函数指针</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%AF%B9%E8%B1%A1"><span class="nav-number">5.7.</span> <span class="nav-text">函数对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">5.8.</span> <span class="nav-text">Lambda表达式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E6%80%81"><span class="nav-number">6.</span> <span class="nav-text">多态</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF"><span class="nav-number">6.1.</span> <span class="nav-text">继承</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%99%9A%E5%87%BD%E6%95%B0"><span class="nav-number">6.2.</span> <span class="nav-text">虚函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E5%A4%9A%E6%80%81-runtime-polymorphism"><span class="nav-number">6.3.</span> <span class="nav-text">运行时多态(runtime polymorphism)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E6%80%81%E7%9A%84%E5%BA%94%E7%94%A8%EF%BC%9AVisitor-pattern"><span class="nav-number">6.4.</span> <span class="nav-text">多态的应用：Visitor pattern</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="nav-number">6.5.</span> <span class="nav-text">模板的简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%A8%A1%E6%9D%BF%E7%B1%BB%E7%9A%84%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E%E5%92%8C%E5%AE%9A%E4%B9%89%E8%A6%81%E6%94%BE%E5%9C%A8%E4%B8%80%E8%B5%B7%EF%BC%9F"><span class="nav-number">6.6.</span> <span class="nav-text">为什么模板类的函数声明和定义要放在一起？</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Yousazoe" src="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><p class="site-author-name" itemprop="name">Yousazoe</p><div class="site-description" itemprop="description">done is better than perfect</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">306</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">49</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">75</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:zoeyousa@gmail.com" title="E-Mail → mailto:zoeyousa@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://github.com/Yousazoe" title="GitHub → https://github.com/Yousazoe" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://twitter.com/YousaZoe" title="Twitter → https://twitter.com/YousaZoe" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://steamcommunity.com/profiles/76561198856466228/" title="Steam → https://steamcommunity.com/profiles/76561198856466228/" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.chess.com/member/yousazoe" title="Chess → https://www.chess.com/member/yousazoe" rel="noopener" target="_blank"><i class="fa fa-chess-pawn fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/399504060" title="Bilibili → https://space.bilibili.com/399504060" rel="noopener" target="_blank"><i class="fa fa-th-large fa-fw"></i></a> </span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml"><i class="fa fa-rss fa-fw"></i></a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="twopeople"><div class="container" style="height:200px"><canvas class="illo" width="800" height="800" style="max-width:200px;max-height:200px;touch-action:none;width:640px;height:640px"></canvas></div><script src="https://img.yousazoe.top/js/twopeople1.js"></script><script src="https://img.yousazoe.top/js/zdog.dist.js"></script><script id="rendered-js" src="https://img.yousazoe.top/js/twopeople.js"></script><style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style></div><div class="cc-license animated" itemprop="sponsor"><link rel="preconnect" href="https://www.netlify.com"><span class="exturl cc-opacity" title="Deploy with Netlify → https://www.netlify.com" data-url="aHR0cHM6Ly93d3cubmV0bGlmeS5jb20="><img width="80" src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://www.netlify.com/img/global/badges/netlify-dark.svg" alt="Netlify"></span></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="translate-style">繁/简：<a id="translateLink" href="javascript:translatePage();">繁体</a></div><script type="text/javascript" src="/js/tw_cn.js"></script><script type="text/javascript">var defaultEncoding=2,translateDelay=0,cookieDomain="https://tding.top/",msgToTraditionalChinese="繁体",msgToSimplifiedChinese="简体",translateButtonId="translateLink";translateInitilization()</script><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">晋ICP备2021009930号 </a><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/icon/beian.png" style="display:inline-block"></div><div class="copyright">© 2020 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Yousazoe</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="Symbols count total">4.6m</span></div><div class="powered-by"><span><a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/YukiNoUta/cdn-static@main/blog/svg/upyun.svg" width="53" height="18" style="fill:currentColor;display:inline-block"></a></span><span class="post-meta-divider">|</span>今早雾霾蔽日，但是不要害怕，太阳依旧在云端</div><div class="busuanzi-count"><script data-pjax="" async="" src="js/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="//unpkg.com/animejs@3.1.0/lib/anime.min.js"></script><script src="//npm.elemecdn.com/pjax/pjax.min.js"></script><script src="//lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="//unpkg.com/lozad@1.16.0/dist/lozad.min.js"></script><script src="//lib.baomitu.com/pangu/4.0.7/pangu.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
    $(document).ready(function () {

    if(location.href.indexOf("#reloaded")==-1){
        location.href=location.href+"#reloaded";
        location.reload();
    }
}）
#在这后面可以加入程序的其他代码  


  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });

  
  NexT.boot.refresh();
  
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  
  NexT.utils.updateSidebarPosition();
});</script><script defer="" src="//img.yousazoe.top/js/three.min.js"></script><script defer="" src="//img.yousazoe.top/js/caidai.js"></script><script data-pjax="">!function(){var e,t,o,n,r=document.getElementsByTagName("link");if(0<r.length)for(i=0;i<r.length;i++)"canonical"==r[i].rel.toLowerCase()&&r[i].href&&(e=r[i].href);t=(e||window.location.protocol).split(":")[0],e=e||window.location.href,window,o=e,n=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(o)||(t="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",n?(t+="?r="+encodeURIComponent(document.referrer),o&&(t+="&l="+o)):o&&(t+="?l="+o),(new Image).src=t)}()</script><script src="/js/local-search.js"></script><script data-pjax="">document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),r=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script data-pjax="">document.querySelectorAll("pre.mermaid").length&&NexT.utils.getScript("//lib.baomitu.com/mermaid/8.4.8/mermaid.min.js",()=>{mermaid.initialize({theme:"forest",logLevel:3,flowchart:{curve:"linear"},gantt:{axisFormat:"%m/%d/%Y"},sequence:{actorMargin:50}})},window.mermaid)</script><div id="pjax"></div><script type="text/javascript" src="/js/cursor/fireworks.js"></script><script src="https://img.yousazoe.top/live2dw/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/hijiki.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!0},log:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:5,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},t.src!==o&&(i.src=o)}()}o(),n.addEventListener("scroll",function(){var t=o,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script type="text/javascript" charset="utf-8" src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script></body></html>