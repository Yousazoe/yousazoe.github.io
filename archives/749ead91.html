<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="mask-icon" href="/images/favicon.ico" color="#222"><meta name="google-site-verification" content="35AYyqm-wpmGmXtkn-vQMrk7AkFl1Do55uHdlLLLT38"><meta name="baidu-site-verification" content="slBbq5f8WxljPytW"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/5.15.4/css/all.min.css"><link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//unpkg.com/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//unpkg.com/pace-js@1.2.4/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"yousazoe.top",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!0,comments:{style:"tabs",active:null,storage:!0,lazyload:!0,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:3,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="RayTracing             引言GAMES101现代图形学入门是由闫令琪老师教授。今天我们来讲光线追踪的第二部分，包括加速结构和辐射度量学。"><meta property="og:type" content="article"><meta property="og:title" content="Acceleration &amp; Radiometry"><meta property="og:url" content="https://yousazoe.top/archives/749ead91.html"><meta property="og:site_name" content="Fl0w3r"><meta property="og:description" content="RayTracing             引言GAMES101现代图形学入门是由闫令琪老师教授。今天我们来讲光线追踪的第二部分，包括加速结构和辐射度量学。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Ezb5YRVXEAgaN9U-20210504181307556.jpeg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082002571.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082039116.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082117000.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082157247.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082243083.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082308744.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/20210506191118.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210506191704932.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/20210506191801.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507081601679.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/20210507081938.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507081718984.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507110108283.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507101513609.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507102614846.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105956877.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507104026859.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105317984.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105404054.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105121041.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507095924595.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507181133620.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507181157097.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqaqefi6efj30tg0gidig.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa71wgkb2j30tr0flju2.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa719xl77j30tf0gxn0j.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqas92e82bj30tl080aea.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa70o4dwxj30tj0fwq4n.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6znke1ej30t80gzk0m.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa703lb04j30tm0gxq52.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6eb3jblj30tj0gwtb9.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6lc6msyj30op0f9wgc.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6o6j6maj30ts0gy40z.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6u0mccbj30tn0gttb6.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6yw42ftj30tr0gtabu.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa67oyowoj30tm0gx0us.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507174106925.png"><meta property="article:published_time" content="2021-04-26T06:07:06.000Z"><meta property="article:modified_time" content="2022-09-01T13:42:33.242Z"><meta property="article:author" content="Yousazoe"><meta property="article:tag" content="Computer Graphics"><meta property="article:tag" content="RayTracing"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Ezb5YRVXEAgaN9U-20210504181307556.jpeg"><link rel="canonical" href="https://yousazoe.top/archives/749ead91.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>Acceleration &amp; Radiometry | Fl0w3r</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Fl0w3r" type="application/atom+xml"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Fl0w3r</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">carpe diem</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-address-card fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-paperclip fa-fw"></i>Links</a></li><li class="menu-item menu-item-photos"><a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>Photos</a></li><li class="menu-item menu-item-artitalk"><a href="/artitalk/" rel="section"><i class="fa fa-calendar fa-fw"></i>Artitalk</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-document"><a href="/docs/" rel="section"><i class="fas fa-book fa-fw"></i>Document</a></li><li class="menu-item menu-item-qexoadmin"><a href="https://blog-yousazoe-qexo.vercel.app/" rel="noopener" target="_blank"><i class="fa fa-database fa-fw"></i>QexoAdmin</a></li><li class="menu-item menu-item-gametracker"><a href="https://yousazoe.notion.site/yousazoe/b05999823bd14b57a7a6cd81fba1a1af?v=21c3398e0bdb429c9b8157b7bf12ff6a" rel="noopener" target="_blank"><i class="fas fa-trophy fa-fw"></i>GameTracker</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://yousazoe.top/archives/749ead91.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><meta itemprop="name" content="Yousazoe"><meta itemprop="description" content="done is better than perfect"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Fl0w3r"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Acceleration &amp; Radiometry</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-04-26 14:07:06" itemprop="dateCreated datePublished" datetime="2021-04-26T14:07:06+08:00">2021-04-26</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/%E7%8E%B0%E4%BB%A3%E5%9B%BE%E5%BD%A2%E5%AD%A6%E5%85%A5%E9%97%A8-GAMES101-Introduction-to-Computer-Graphics/" itemprop="url" rel="index"><span itemprop="name">现代图形学入门 (GAMES101-Introduction to Computer Graphics)</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="fas fa-pen"></i></span><span>7.2k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span>13 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Ezb5YRVXEAgaN9U-20210504181307556.jpeg"></p><div align="center"><font size="3"><i><a target="_blank" rel="noopener" href="https://twitter.com/phoronix/status/1384568137681670154">RayTracing</a></i></font></div><h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p>GAMES101现代图形学入门是由闫令琪老师教授。今天我们来讲光线追踪的第二部分，包括加速结构和辐射度量学。</p><span id="more"></span><iframe src="//player.bilibili.com/player.html?aid=90798049&amp;bvid=BV1X7411F744&amp;cid=155049937&amp;page=14&amp;high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen=""></iframe><h3 id="Announcements"><a href="#Announcements" class="headerlink" title="Announcements"></a>Announcements</h3><p>Grading of resubmissions — we’re working on that</p><p>GTC news: DLSS 2.0</p><ul><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/116211994">https://zhuanlan.zhihu.com/p/116211994</a></li></ul><p>GTC news: RTXGI</p><ul><li><a target="_blank" rel="noopener" href="https://developer.nvidia.com/rtxgi">https://developer.nvidia.com/rtxgi</a></li></ul><p>Personal feeling</p><ul><li>Offline rendering techniques will soon become real-time</li><li>Current real-time rendering techniques will still be useful</li></ul><p>Next lectures won’t be easy</p><h3 id="Using-AABBs-to-accelerate-ray-tracing"><a href="#Using-AABBs-to-accelerate-ray-tracing" class="headerlink" title="Using AABBs to accelerate ray tracing"></a>Using AABBs to accelerate ray tracing</h3><h4 id="Uniform-grids"><a href="#Uniform-grids" class="headerlink" title="Uniform grids"></a>Uniform grids</h4><p>假如场景非常复杂，我要去用光线和场景中任何一个物体求交。现在我已经知道如果可以把一些物体包围在盒子里，那我先跟盒子求交再考虑是否需要和物体求交，这里就是直接应用这样一个思想：</p><h5 id="Preprocess-–-Build-Acceleration-Grid"><a href="#Preprocess-–-Build-Acceleration-Grid" class="headerlink" title="Preprocess – Build Acceleration Grid"></a>Preprocess – Build Acceleration Grid</h5><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082002571.png"></p><ol><li>我先找到这么一个场景，在做光线追踪之前对场景做预处理，把场景的包围盒找出来，当然图中的包围盒不是最小的包围盒。</li></ol><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082039116.png"></p><ol start="2"><li>找到包围盒后把盒子分成一堆格子，图中二维的场景分解出二维的格子：一个个小方块。</li></ol><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082117000.png"></p><ol start="3"><li>划分格子后我们判定哪些格子里面可能有物体，与物体相交的这些格子我们标记为某个类型，图中涂成了灰色。</li></ol><h5 id="Ray-Scene-Intersection"><a href="#Ray-Scene-Intersection" class="headerlink" title="Ray-Scene Intersection"></a>Ray-Scene Intersection</h5><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082157247.png"></p><p>在预处理之后我就知道在这些场景里有一些格子，中间可能有一些物体。那么现在我就可以做光线追踪，光线从左出发朝右上角去，它会率先和第一个格子相交，发现有交点但格子里没有东西，所以不用做与实际物体相交这么一个操作（这里我们假设光线与盒子求交是非常快的，与实际物体求交是非常慢的）。</p><p>当光线到中间蓝色格子时光线与它有交点，而且格子里面有物体，这说明光线有可能与格子内物体相交。这时我们再做一个光线与物体的求交，发现与物体没有交点；而当光线在深蓝色格子时，发现光线与物体相交，那我就找到了一个交点，同样道理我们可以找到所有交点。</p><p>加速结构的原理其实就是多做光线与盒子求交，尽量避免光线与物体求交。</p><h5 id="Grid-Resolution"><a href="#Grid-Resolution" class="headerlink" title="Grid Resolution?"></a>Grid Resolution?</h5><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082243083.png"></p><p>在格子稀疏的极端情况假设我们把整个空间划分为1*1的格子，基本和不划格子一模一样不会有任何加速的意义。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210428082308744.png"></p><p>另一种极端情况是格子太密集，意味着我们要做好多次光线与格子求交，效率下降。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/20210506191118.png"></p><p>正常情况下人们发现了一些实际应用效果不错的规律，划分格子<code>#cell</code>的数量可以通过常数<code>C</code>与物体数量<code>#objs</code>相乘得到，在三维空间中<code>C</code>大约为27。</p><h5 id="Uniform-Grids-–-When-They-Work-Well"><a href="#Uniform-Grids-–-When-They-Work-Well" class="headerlink" title="Uniform Grids – When They Work Well"></a>Uniform Grids – When They Work Well</h5><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210506191704932.png"></p><p>Grids work well on large collections of objects that are distributed evenly in size and space.</p><p>格子提供的加速效果在上例展示的比较好，在这个场景各个地方都有一些几何的物体，它们在场景中分布比较均匀，这样的场景格子的加速结构效果比较好。</p><h5 id="Uniform-Grids-–-When-They-Fail"><a href="#Uniform-Grids-–-When-They-Fail" class="headerlink" title="Uniform Grids – When They Fail"></a>Uniform Grids – When They Fail</h5><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/20210506191801.png"></p><p>“Teapot in a stadium” problem.</p><p>对于这个场景比上个场景相对空旷，好比在一个大的运动场光线经过好久才与实际格子相交，但在此之前我们进行了大量关于格子的无效判断，所以如果场景分布的并不均匀，格子方法可能并不奏效。</p><h4 id="Spatial-partitions"><a href="#Spatial-partitions" class="headerlink" title="Spatial partitions"></a>Spatial partitions</h4><p>格子的大小个数是相同的，但事实上在一些稀疏的地方我们不需要这么多格子，我们可以在空旷的地方用大一些的格子，而在一些密集的地方再用小一点的格子。</p><h5 id="Spatial-Partitioning-Examples"><a href="#Spatial-Partitioning-Examples" class="headerlink" title="Spatial Partitioning Examples"></a>Spatial Partitioning Examples</h5><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507081601679.png"></p><p>空间划分这个问题很早很早就有了，在计算几何上大家有各种各样的研究。图形学作为一个应用，在上面有三种空间划分结构：Oct-Tree八叉树（二维情况是四叉树），通过这种方式我们把空间切成一些不均匀的块并且把它组织成了树结构。</p><p>但人们不喜欢用八叉树，在其他维度的情况下八叉树的表现不是很好。人们发明了一种办法能让空间得到划分并且与维度无关，这就是KD-Tree。它与八叉树几乎完全相同，只不过每一次它找到格子总是沿着某一个轴把它砍开，如图第一次切分形成上下两块，对上下两个块再分别竖直砍一刀，左边和右边继续做下去水平砍一刀……整个空间就被划分成类似于二叉树的结构，每个节点只有两个叉只会分成两个区域，并且从我们刚才描述的过程中可以看到水平与竖直的划分是交替的，这样一来我们可以保证空间均匀的划分方式。</p><p>同样道理还有很多划分方法，比如上面的BSP-Tree，通过对空间进行二分，与KD-Tree的区别是不是横平竖直的砍。而AABB的好处是横平竖直都是平行的非常好计算，这样的话BSP-Tree在这方面赶不上KD-Tree，并且在高维情况下不容易计算，三维情况可能就需要一个面来划分，更不用说更高维情况可能需要超平面越来越复杂。</p><h5 id="KD-Tree-Pre-Processing"><a href="#KD-Tree-Pre-Processing" class="headerlink" title="KD-Tree Pre-Processing"></a>KD-Tree Pre-Processing</h5><p>KD-Tree是在光线追踪之前提前做好的，我们需要提前做好这个加速结构。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/20210507081938.png"></p><p>首先场景包围在最大的盒子A中，我们假设沿着竖直方向划分为两部分：蓝色部分与绿色部分。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507081718984.png"></p><p>对于蓝色部分与绿色部分我们都需要进行划分，但这里我们展示其中的一半以绿色部分为例做解释，蓝色部分如法炮制即可。可以看到绿色部分B也被分为绿色和橙色两个部分，以此类推划分出C、D等等，它最后就会形成一个树。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507110108283.png"></p><h5 id="Data-Structure-for-KD-Trees"><a href="#Data-Structure-for-KD-Trees" class="headerlink" title="Data Structure for KD-Trees"></a>Data Structure for KD-Trees</h5><p><strong>Internal nodes store</strong></p><ul><li>split axis: x-, y-, or z-axis</li><li>split position: coordinate of split plane along axis</li><li>children: pointers to child nodes</li><li><strong>No objects are stored in internal nodes</strong></li></ul><p><strong>Leaf nodes store</strong></p><ul><li>list of objects</li></ul><p>对于任何一个节点，我都应该知道它应该沿着哪个轴划分，并且划分在哪儿。对于中间节点一定有它的子节点，既然划分一次一定有两个子节点，而实际物体不存在中间节点，只存在叶子节点上。</p><h5 id="Traversing-a-KD-Tree"><a href="#Traversing-a-KD-Tree" class="headerlink" title="Traversing a KD-Tree"></a>Traversing a KD-Tree</h5><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507101513609.png"></p><p>这个结构如何让我们加速光线追踪的呢？假设有一个光线从左上到右下，首先场景有一个最大的包围盒A，判定是否和A有交点，发现和A有交点，那么光线就有可能和盒子的左边和右边两个子节点有交集：</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507102614846.png"></p><p>这时需要考虑是否和最大的盒子A的子节点有交点，发现1号蓝色区域的$t_{min}、t_{max}$，假设这棵树就是这样，那么1就是叶子节点，那么这个光线就需要和1叶子节点的所有物体求交：</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105956877.png"></p><p>同样道理，两个子节点都需要判定是不是有交点，跟右边的B区域求交发现也有交点。光线既然和B相交，那么就有可能和其子节点2和C相交：</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507104026859.png"></p><p>在区域2中依然有交点，但2是叶子节点，那么我需要和叶子节点所有物体求交：</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105317984.png"></p><p>在和区域2判定交点之后欧还需要和C判定交点，发现同样有交点：</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105404054.png"></p><p>同样道理继续判定和3有交点，并且3是叶子节点，和所有物体求交。最后求交到$t_{hit}$，而区域5没有交点，所以光线没有必要判定和区域5是否有交点：</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507105121041.png"></p><p>大家可以发现道理很简单：如果光线和某一个格子没有交点，那么什么都不用做；如果光线和某一个格子有交点，那么我就知道光线和它的两个子节点可能有交点，所以都看一下直到光线打到叶子节点，如果和叶子节点还没有交点那么什么都不用做；如果打到叶子节点并且光线和叶子节点有交点，那么叶子节点所有物体都要求交。</p><p>通过KD-Tree的建立，我们可以利用这种类似二分查找的方法找到这个光线和什么样的物体有交点。</p><p>对于KD-Tree有一个明确的问题：场景由三角形构成，而通过空间划分方式给出包围盒，我得知道它和哪些三角形有交集。这是一个非常非常难的事情，很不容易写对，算法是有的，但你很难判断三角形是否和立方体有交集。也许有人觉得只要判定三角形一个顶点在盒子里就算相交，但实际上有一种情况三角形三个顶点都不在盒子里但却是相交的（三维空间中一个很小的盒子垂直插在平面三角形内部）。</p><p>这也是为什么近十年大家渐渐不用KD-Tree的原因之一。另外一个问题是图中有的圆圈和很多AABB都有交集，如果这些盒子都是叶子节点，那么每个节点都要存这个物体，也就是说一个物体有可能出现在多个叶子节点里。这个性质并不怎么好，人们不希望这样，我们希望一个物体只在一个叶子节点里，KD-Tree在这一点上并不直观。</p><h3 id="Object-Partitions-amp-Bounding-Volume-Hierarchy-BVH"><a href="#Object-Partitions-amp-Bounding-Volume-Hierarchy-BVH" class="headerlink" title="Object Partitions &amp; Bounding Volume Hierarchy (BVH)"></a>Object Partitions &amp; Bounding Volume Hierarchy (BVH)</h3><p>人们发现另一种划分方法，这次的划分不是从空间做起，而是从物体做起。这就是我们要介绍的Object partition，而这种划分形成的加速结构也被称为BVH。这种加速结构得到了非常广泛的应用，在图形学里无论实时还是离线光线追踪大家都是用这种结构，因为它解决了刚才KD-Tree的两个问题。</p><h4 id="Bounding-Volume-Hierarchy-BVH"><a href="#Bounding-Volume-Hierarchy-BVH" class="headerlink" title="Bounding Volume Hierarchy (BVH)"></a>Bounding Volume Hierarchy (BVH)</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507095924595.png"></p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507181133620.png"></p><p>一开始给定一个场景，我们拿盒子包起来。BVH把物体（图中为三角形）组织成两个部分，把这两部分重新求它的包围盒形成两个节点。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507181157097.png"></p><p>同样道理继续划分物体，以之前蓝色的节点为例再分为蓝、绿两部分三角形，继续重新计算包围盒。以此类推划分到一个包围盒比如只剩下五个三角形为止。</p><h4 id="Summary-Building-BVHs"><a href="#Summary-Building-BVHs" class="headerlink" title="Summary: Building BVHs"></a>Summary: Building BVHs</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqaqefi6efj30tg0gidig.jpg"></p><p>总结一下BVH的过程：</p><ol><li>找到包围盒</li><li>递归的把任何一个包围盒中的物体拆成两个部分，并且两个部分重新计算包围盒</li><li>正常情况下当我觉得叶子节点有足够少的三角形就停止</li></ol><h4 id="Building-BVHs"><a href="#Building-BVHs" class="headerlink" title="Building BVHs"></a>Building BVHs</h4><p>How to subdivide a node?</p><ul><li>Choose a dimension to split</li><li>Heuristic #1: Always choose the longest axis in node</li><li>Heuristic #2: Split node at location of <strong>median</strong> object</li></ul><p>Termination criteria?</p><ul><li>Heuristic: stop when node contains few elements (e.g. 5)</li></ul><p>那么实际上如何去划分一个节点，我们可以选一个维度去划分，跟KD-Tree学习每一次选择一个不同的维度保证均匀。还有一些其他的技巧，为了让这些节点在空间中有均匀的分布，我每一次只沿着最长的轴进行划分；人们发现一个节点知道沿着某一个轴划分，取中间的物体将其分成两半，可以保证划分后两边三角形数量差不多，这棵树接近平衡。</p><h4 id="Data-Structure-for-BVHs"><a href="#Data-Structure-for-BVHs" class="headerlink" title="Data Structure for BVHs"></a>Data Structure for BVHs</h4><p>Internal nodes store</p><ul><li>Bounding box</li><li>Children: pointers to child nodes</li></ul><p>Leaf nodes store</p><ul><li>Bounding box</li><li>List of objects</li></ul><p>Nodes represent subset of primitives in scene</p><ul><li>All objects in subtree</li></ul><p>BVH中间节点只存包围盒和它子节点的指针，叶子节点才存实际的物体。</p><h4 id="BVH-Traversal"><a href="#BVH-Traversal" class="headerlink" title="BVH Traversal"></a>BVH Traversal</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa71wgkb2j30tr0flju2.jpg"></p><p>如果光线与整个BVH节点都不相交，那么什么也不会发生；如果光线和包围盒相交有两种可能：如果本身是叶子节点，这种情况需要光线和所有物体求交，返回最近的交点；如果不是叶子节点那么就算中间节点，光线可能与它的两个子节点有交点，那么我们分别递归求出子节点的交点，返回最近的那个。</p><h4 id="Spatial-vs-Object-Partitions"><a href="#Spatial-vs-Object-Partitions" class="headerlink" title="Spatial vs Object Partitions"></a>Spatial vs Object Partitions</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa719xl77j30tf0gxn0j.jpg"></p><h3 id="Basic-radiometry"><a href="#Basic-radiometry" class="headerlink" title="Basic radiometry"></a>Basic radiometry</h3><h4 id="Radiometry-—-Motivation"><a href="#Radiometry-—-Motivation" class="headerlink" title="Radiometry — Motivation"></a>Radiometry — Motivation</h4><p>Observation</p><ul><li>In assignment 3, we implement the Blinn-Phong model</li><li>Light intensity I is 10, for example</li><li>But 10 what?</li></ul><p>Do you think Whitted style ray tracing gives you CORRECT results?</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqas92e82bj30tl080aea.jpg"></p><p>为什么要提辐射度量学呢？之前我们光照强度定义为10，那么这个10是什么？10个？不合理吧，它肯定得有单位，有自己的物理意义，而之前的Blin-Phong模型我们把它极大的简化为一个数，那肯定是不对的。另一方面我们做的Whitted风格的光线追踪真的真实吗？大家一看就知道非常假，看上去肯定不是真实存在的场景，因为我们中间做了各种各样的简化。</p><p>辐射度量学是一个精准的给我们实际光的物理量的一个方法，我们把光精确定义出来，包括物体表面如何和光进行作用精确的表述出来，涉及光源、材质、光线的传播方法等等。只有这样我们才能得到最精确的结果，而整个一套路径追踪的体系都是建立在这个基础上的。</p><h4 id="Radiometry"><a href="#Radiometry" class="headerlink" title="Radiometry"></a>Radiometry</h4><p>Measurement system and units for illumination</p><p>Accurately measure the spatial properties of light</p><ul><li>New terms: Radiant flux, intensity, irradiance, radiance</li></ul><p>Perform lighting calculations in a physically correct manner</p><p>My personal way of learning things:</p><ul><li>WHY, WHAT, then HOW</li></ul><p>辐射度量学讲的是如何去描述光照，它定义了一系列方法和一系列的单位，它能给我们光各种各样的空间属性。并且辐射度量学仍然是基于几何光学来做的，我们认为光线仍然以直线传播，没有波动性。总的来说，辐射度量学是一个在物理上准确定义光照的方法。</p><h3 id="Radiant-Energy-and-Flux-Power"><a href="#Radiant-Energy-and-Flux-Power" class="headerlink" title="Radiant Energy and Flux (Power)"></a>Radiant Energy and Flux (Power)</h3><h4 id="Radiant-Energy-and-Flux-Power-1"><a href="#Radiant-Energy-and-Flux-Power-1" class="headerlink" title="Radiant Energy and Flux (Power)"></a>Radiant Energy and Flux (Power)</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa70o4dwxj30tj0fwq4n.jpg"></p><ul><li><strong>Radiant Energy</strong>：电磁辐射能量理解成光源辐射的东西肯定永远是能量，首先我们用能量描述它，单位是焦耳。可以想象太阳能板在太阳照射时会发热，再把它转化为电能存下来</li><li><strong>Radiant Flux</strong>：flux人们又经常叫它power，是单位时间的能量，直译为辐射通量/辐射功率，得到的类似于功率，单位为瓦特或流明。还是以太阳能为例，你照的时间越长能量越多，分析这个问题时肯定要固定某一个短时间，考虑单位时间的性质</li></ul><h4 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6znke1ej30t80gzk0m.jpg"></p><p>flux这个概念还可以从另外一个角度定义。我们知道光线传播辐射各种各样的光子，如果我们有一个感光的平面如上图所示，单位时间通过光子的数量我们就认为是flux。这很好理解，一个灯泡看上去更亮是因为它辐射出更多的光子，也就是灯泡看上去有多亮。</p><h4 id="Important-Light-Measurements-of-Interest"><a href="#Important-Light-Measurements-of-Interest" class="headerlink" title="Important Light Measurements of Interest"></a>Important Light Measurements of Interest</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa703lb04j30tm0gxq52.jpg"></p><p>有了上面两个概念我们就可以研究其他的一些物理量，比如说光源会辐射出各种各样的能量，我们如何去定义这些东西；还要定义任何一个物体表面它会接收到多少能量；光线在传播过程应该用什么方法来定义：</p><ol><li>一个光源它往四面八方都有可能辐射能量，我会定义一个方向性的跟能量相关的概念：Radiant Intensity，有时人们会直接说Intensity，直译为辐射强度</li><li>一个物体表面它接收多少光的能量，这个概念叫做Irradiance</li><li>光线在传播中应该如何度量它的能量，我们用的是Radiance这个概念</li></ol><h3 id="Radiant-Intensity"><a href="#Radiant-Intensity" class="headerlink" title="Radiant Intensity"></a>Radiant Intensity</h3><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6eb3jblj30tj0gwtb9.jpg"></p><p>单位立体角的辐射强度很好理解，但什么是立体角？</p><h4 id="Angles-and-Solid-Angles"><a href="#Angles-and-Solid-Angles" class="headerlink" title="Angles and Solid Angles"></a>Angles and Solid Angles</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6lc6msyj30op0f9wgc.jpg"></p><p>数学上角的定义一般是弧度，我们认为一个角从圆心出发往某一方向张开一定角度，它会打到圆弧上面对应一段弧长，那么我定义角度就是弧长/半径，整个圆的角度是$2 \pi r / r = 2\pi$。大家可以发现对圆的缩放并不影响角度，因为弧长和半径会同步缩放，所以这个定义比较合理。</p><p>立体角就是角度在三维空间中的延伸。在三维空间中我们找一个球，从球心出发形成某一个有一定大小的锥。这个锥会打到球面上，对应球面上的一个面积。立体角的定义就是这个锥对应的球面面积/半径的平方，也是弧度制在空间中的延伸，整个球对应的立体角为$4 \pi r^2 / r^2 = 4\pi$。这就是立体角的定义，说白了就是空间中的角有多大。</p><h4 id="Differential-Solid-Angles"><a href="#Differential-Solid-Angles" class="headerlink" title="Differential Solid Angles"></a>Differential Solid Angles</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6o6j6maj30ts0gy40z.jpg"></p><p>我们平常会定义单位立体角。对于一个单位立体角，我们就找一个单位的面积/半径平方，现在通过离z轴的夹角$\theta$和绕z轴旋转的夹角$\phi$定义一个球面上唯一的方向。如果我们取一个单位面积认为是一个矩形，应该算出长和宽各是多少，但我们发现横着的边的长度就是$d\phi$，竖着的这条边就是$r\sin{\theta}$长度，通过这种方式定义出小方块的面积应该是$r^2\sin{\theta d\theta d\phi}$，带入立体角公式得到$\sin{\theta}d\theta d\phi$。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6u0mccbj30tn0gttb6.jpg"></p><p>对于整个一个球来说，如果我要把它所有方向对应的单位立体角积分就是整个球对应的立体角。</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa6yw42ftj30tr0gtabu.jpg"></p><h4 id="Isotropic-Point-Source"><a href="#Isotropic-Point-Source" class="headerlink" title="Isotropic Point Source"></a>Isotropic Point Source</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/008i3skNgy1gqa67oyowoj30tm0gx0us.jpg"></p><p>我们定义一个点光源，Radiant Intensity定义就是一个光源在任何一个方向上的亮度，它总共的亮度是Radiant Flux，除以单位立体角，也就是从任意方向看过去它的亮度。根据积分结果，如果一个点光源均匀辐射出能量，那么任何一个方向上对应的Radiant Intensity就是它的power/4pi，得到方向上所谓的强度。</p><h4 id="Modern-LED-Light"><a href="#Modern-LED-Light" class="headerlink" title="Modern LED Light"></a>Modern LED Light</h4><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/image-20210507174106925.png"></p><p>实际上看一个LED灯泡的瓦数是和白炽灯相比，实际上它的能量开销很低。如果我认为该灯泡向四面八方辐射的能量是一样的，那我可以算任意一个方向的intensity，65坎德拉算出来就是某一方向对应的intensity。</p><br><center><a class="btn" target="_blank" rel="noopener" href="https://sites.cs.ucsb.edu/~lingqi/teaching/resources/GAMES101_Lecture_14.pdf"><i class="fas fa-download"></i>GAMES101_Lecture_14</a></center></div><div class="popular-posts-header">Related Posts</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/f262b578.html" rel="bookmark">Monte Carlo Path Tracing</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/ad809f54.html" rel="bookmark">Light Transport &amp; Global Illumination</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/bc6dc1aa.html" rel="bookmark">Whitted Style Ray Tracing</a></div></li></ul><footer class="post-footer"><div class="post-tags"><a href="/tags/Computer-Graphics/" rel="tag"># Computer Graphics</a> <a href="/tags/RayTracing/" rel="tag"># RayTracing</a></div><div class="post-nav"><div class="post-nav-item"><a href="/archives/bc6dc1aa.html" rel="prev" title="Whitted Style Ray Tracing"><i class="fa fa-chevron-left"></i> Whitted Style Ray Tracing</a></div><div class="post-nav-item"><a href="/archives/7d5f0453.html" rel="next" title="Introduction,big-O Notation,arithmetic">Introduction,big-O Notation,arithmetic <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:e}=CONFIG.comments;if(CONFIG.comments.storage&&(e=localStorage.getItem("comments_active")||e),e){let t=document.querySelector(`a[href="#comment-${e}"]`);t&&t.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">引言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Announcements"><span class="nav-number">2.</span> <span class="nav-text">Announcements</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-AABBs-to-accelerate-ray-tracing"><span class="nav-number">3.</span> <span class="nav-text">Using AABBs to accelerate ray tracing</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Uniform-grids"><span class="nav-number">3.1.</span> <span class="nav-text">Uniform grids</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Preprocess-%E2%80%93-Build-Acceleration-Grid"><span class="nav-number">3.1.1.</span> <span class="nav-text">Preprocess – Build Acceleration Grid</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Ray-Scene-Intersection"><span class="nav-number">3.1.2.</span> <span class="nav-text">Ray-Scene Intersection</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Grid-Resolution"><span class="nav-number">3.1.3.</span> <span class="nav-text">Grid Resolution?</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Uniform-Grids-%E2%80%93-When-They-Work-Well"><span class="nav-number">3.1.4.</span> <span class="nav-text">Uniform Grids – When They Work Well</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Uniform-Grids-%E2%80%93-When-They-Fail"><span class="nav-number">3.1.5.</span> <span class="nav-text">Uniform Grids – When They Fail</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Spatial-partitions"><span class="nav-number">3.2.</span> <span class="nav-text">Spatial partitions</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Spatial-Partitioning-Examples"><span class="nav-number">3.2.1.</span> <span class="nav-text">Spatial Partitioning Examples</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#KD-Tree-Pre-Processing"><span class="nav-number">3.2.2.</span> <span class="nav-text">KD-Tree Pre-Processing</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Data-Structure-for-KD-Trees"><span class="nav-number">3.2.3.</span> <span class="nav-text">Data Structure for KD-Trees</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Traversing-a-KD-Tree"><span class="nav-number">3.2.4.</span> <span class="nav-text">Traversing a KD-Tree</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Object-Partitions-amp-Bounding-Volume-Hierarchy-BVH"><span class="nav-number">4.</span> <span class="nav-text">Object Partitions &amp; Bounding Volume Hierarchy (BVH)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Bounding-Volume-Hierarchy-BVH"><span class="nav-number">4.1.</span> <span class="nav-text">Bounding Volume Hierarchy (BVH)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Summary-Building-BVHs"><span class="nav-number">4.2.</span> <span class="nav-text">Summary: Building BVHs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Building-BVHs"><span class="nav-number">4.3.</span> <span class="nav-text">Building BVHs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Data-Structure-for-BVHs"><span class="nav-number">4.4.</span> <span class="nav-text">Data Structure for BVHs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BVH-Traversal"><span class="nav-number">4.5.</span> <span class="nav-text">BVH Traversal</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Spatial-vs-Object-Partitions"><span class="nav-number">4.6.</span> <span class="nav-text">Spatial vs Object Partitions</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Basic-radiometry"><span class="nav-number">5.</span> <span class="nav-text">Basic radiometry</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Radiometry-%E2%80%94-Motivation"><span class="nav-number">5.1.</span> <span class="nav-text">Radiometry — Motivation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Radiometry"><span class="nav-number">5.2.</span> <span class="nav-text">Radiometry</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Radiant-Energy-and-Flux-Power"><span class="nav-number">6.</span> <span class="nav-text">Radiant Energy and Flux (Power)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Radiant-Energy-and-Flux-Power-1"><span class="nav-number">6.1.</span> <span class="nav-text">Radiant Energy and Flux (Power)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Flux"><span class="nav-number">6.2.</span> <span class="nav-text">Flux</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Important-Light-Measurements-of-Interest"><span class="nav-number">6.3.</span> <span class="nav-text">Important Light Measurements of Interest</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Radiant-Intensity"><span class="nav-number">7.</span> <span class="nav-text">Radiant Intensity</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Angles-and-Solid-Angles"><span class="nav-number">7.1.</span> <span class="nav-text">Angles and Solid Angles</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Differential-Solid-Angles"><span class="nav-number">7.2.</span> <span class="nav-text">Differential Solid Angles</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Isotropic-Point-Source"><span class="nav-number">7.3.</span> <span class="nav-text">Isotropic Point Source</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Modern-LED-Light"><span class="nav-number">7.4.</span> <span class="nav-text">Modern LED Light</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Yousazoe" src="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><p class="site-author-name" itemprop="name">Yousazoe</p><div class="site-description" itemprop="description">done is better than perfect</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">288</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">45</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">71</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:zoeyousa@gmail.com" title="E-Mail → mailto:zoeyousa@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://github.com/Yousazoe" title="GitHub → https://github.com/Yousazoe" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://twitter.com/YousaZoe" title="Twitter → https://twitter.com/YousaZoe" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.weibo.com/6034231696/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo&amp;is_all=1" title="Weibo → https://www.weibo.com/6034231696/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo&amp;is_all=1" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://steamcommunity.com/profiles/76561198856466228/" title="Steam → https://steamcommunity.com/profiles/76561198856466228/" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.chess.com/member/yousazoe" title="Chess → https://www.chess.com/member/yousazoe" rel="noopener" target="_blank"><i class="fa fa-chess-pawn fa-fw"></i></a> </span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml"><i class="fa fa-rss fa-fw"></i></a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="twopeople"><div class="container" style="height:200px"><canvas class="illo" width="800" height="800" style="max-width:200px;max-height:200px;touch-action:none;width:640px;height:640px"></canvas></div><script src="https://img.yousazoe.top/js/twopeople1.js"></script><script src="https://img.yousazoe.top/js/zdog.dist.js"></script><script id="rendered-js" src="https://img.yousazoe.top/js/twopeople.js"></script><style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style></div><div class="cc-license animated" itemprop="sponsor"><link rel="preconnect" href="https://www.netlify.com"><span class="exturl cc-opacity" title="Deploy with Netlify → https://www.netlify.com" data-url="aHR0cHM6Ly93d3cubmV0bGlmeS5jb20="><img width="80" src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://www.netlify.com/img/global/badges/netlify-dark.svg" alt="Netlify"></span></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="translate-style">繁/简：<a id="translateLink" href="javascript:translatePage();">繁体</a></div><script type="text/javascript" src="/js/tw_cn.js"></script><script type="text/javascript">var defaultEncoding=2,translateDelay=0,cookieDomain="https://tding.top/",msgToTraditionalChinese="繁体",msgToSimplifiedChinese="简体",translateButtonId="translateLink";translateInitilization()</script><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">晋ICP备2021009930号 </a><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/icon/beian.png" style="display:inline-block"></div><div class="copyright">© 2020 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Yousazoe</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="Symbols count total">4.5m</span></div><div class="powered-by"><span><a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/YukiNoUta/cdn-static@main/blog/svg/upyun.svg" width="53" height="18" style="fill:currentColor;display:inline-block"></a></span><span class="post-meta-divider">|</span>今早雾霾蔽日，但是不要害怕，太阳依旧在云端</div><div class="busuanzi-count"><script data-pjax="" async="" src="js/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="//unpkg.com/animejs@3.1.0/lib/anime.min.js"></script><script src="//npm.elemecdn.com/pjax/pjax.min.js"></script><script src="//lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="//unpkg.com/lozad@1.16.0/dist/lozad.min.js"></script><script src="//lib.baomitu.com/pangu/4.0.7/pangu.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
    $(document).ready(function () {

    if(location.href.indexOf("#reloaded")==-1){
        location.href=location.href+"#reloaded";
        location.reload();
    }
}）
#在这后面可以加入程序的其他代码  


  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });

  
  NexT.boot.refresh();
  
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  
  NexT.utils.updateSidebarPosition();
});</script><script defer="" src="//img.yousazoe.top/js/three.min.js"></script><script defer="" src="//img.yousazoe.top/js/caidai.js"></script><script data-pjax="">!function(){var e,t,o,n,r=document.getElementsByTagName("link");if(0<r.length)for(i=0;i<r.length;i++)"canonical"==r[i].rel.toLowerCase()&&r[i].href&&(e=r[i].href);t=(e||window.location.protocol).split(":")[0],e=e||window.location.href,window,o=e,n=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(o)||(t="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",n?(t+="?r="+encodeURIComponent(document.referrer),o&&(t+="&l="+o)):o&&(t+="?l="+o),(new Image).src=t)}()</script><script src="/js/local-search.js"></script><script data-pjax="">document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),r=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script data-pjax="">document.querySelectorAll("pre.mermaid").length&&NexT.utils.getScript("//lib.baomitu.com/mermaid/8.4.8/mermaid.min.js",()=>{mermaid.initialize({theme:"forest",logLevel:3,flowchart:{curve:"linear"},gantt:{axisFormat:"%m/%d/%Y"},sequence:{actorMargin:50}})},window.mermaid)</script><div id="pjax"><script>"undefined"==typeof MathJax?(window.MathJax={loader:{source:{"[tex]/amsCd":"[tex]/amscd","[tex]/AMScd":"[tex]/amscd"}},tex:{inlineMath:{"[+]":[["$","$"]]},tags:"ams"},options:{renderActions:{findScript:[10,n=>{document.querySelectorAll('script[type^="math/tex"]').forEach(e=>{var t=!!e.type.match(/; *mode=display/);const a=new n.options.MathItem(e.textContent,n.inputJax[0],t);t=document.createTextNode("");e.parentNode.replaceChild(t,e),a.start={node:t,delim:"",n:0},a.end={node:t,delim:"",n:0},n.math.push(a)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}},function(){var e=document.createElement("script");e.src="//lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js",e.defer=!0,document.head.appendChild(e)}()):(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset())</script></div><script type="text/javascript" src="/js/cursor/fireworks.js"></script><script src="https://img.yousazoe.top/live2dw/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/hijiki.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!0},log:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:5,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},t.src!==o&&(i.src=o)}()}o(),n.addEventListener("scroll",function(){var t=o,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script type="text/javascript" charset="utf-8" src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script></body></html>