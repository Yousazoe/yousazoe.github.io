<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="mask-icon" href="/images/favicon.ico" color="#222"><meta name="google-site-verification" content="35AYyqm-wpmGmXtkn-vQMrk7AkFl1Do55uHdlLLLT38"><meta name="baidu-site-verification" content="slBbq5f8WxljPytW"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/5.15.4/css/all.min.css"><link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//unpkg.com/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//unpkg.com/pace-js@1.2.4/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"yousazoe.top",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!0,comments:{style:"tabs",active:null,storage:!0,lazyload:!0,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:3,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="引言Welcome to part 3 of the Starcraft AI with Python series. In the previous tutorials we learned the basics of writing an AI agent within Starcraft 2, but we’ve not yet been able to defeat the enemy"><meta property="og:type" content="article"><meta property="og:title" content="Attacking and Defeating the Enemy"><meta property="og:url" content="https://yousazoe.top/archives/ebbc29f6.html"><meta property="og:site_name" content="Fl0w3r"><meta property="og:description" content="引言Welcome to part 3 of the Starcraft AI with Python series. In the previous tutorials we learned the basics of writing an AI agent within Starcraft 2, but we’ve not yet been able to defeat the enemy"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/SCII3.jpeg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/void-rays-defense.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/void-ray-victory.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/void-rays-vs-terran.jpg"><meta property="article:published_time" content="2022-03-11T12:03:46.000Z"><meta property="article:modified_time" content="2022-07-13T23:29:40.269Z"><meta property="article:author" content="Yousazoe"><meta property="article:tag" content="Python"><meta property="article:tag" content="StarCraft2"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/SCII3.jpeg"><link rel="canonical" href="https://yousazoe.top/archives/ebbc29f6.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>Attacking and Defeating the Enemy | Fl0w3r</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Fl0w3r" type="application/atom+xml"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Fl0w3r</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">carpe diem</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-address-card fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-paperclip fa-fw"></i>Links</a></li><li class="menu-item menu-item-photos"><a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>Photos</a></li><li class="menu-item menu-item-artitalk"><a href="/artitalk/" rel="section"><i class="fa fa-calendar fa-fw"></i>Artitalk</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-document"><a href="/docs/" rel="section"><i class="fas fa-book fa-fw"></i>Document</a></li><li class="menu-item menu-item-qexoadmin"><a href="https://blog-yousazoe-qexo.vercel.app/" rel="noopener" target="_blank"><i class="fa fa-database fa-fw"></i>QexoAdmin</a></li><li class="menu-item menu-item-gametracker"><a href="https://yousazoe.notion.site/yousazoe/b05999823bd14b57a7a6cd81fba1a1af?v=21c3398e0bdb429c9b8157b7bf12ff6a" rel="noopener" target="_blank"><i class="fas fa-trophy fa-fw"></i>GameTracker</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://yousazoe.top/archives/ebbc29f6.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><meta itemprop="name" content="Yousazoe"><meta itemprop="description" content="done is better than perfect"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Fl0w3r"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Attacking and Defeating the Enemy</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-03-11 20:03:46" itemprop="dateCreated datePublished" datetime="2022-03-11T20:03:46+08:00">2022-03-11</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/%E6%98%9F%E9%99%85%E4%BA%89%E9%9C%B82%E4%B8%8E%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD-Building-Starcraft-2-AI-in-Python-with-Python-sc2/" itemprop="url" rel="index"><span itemprop="name">星际争霸2与人工智能 (Building Starcraft 2 AI in Python with Python-sc2)</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="fas fa-pen"></i></span><span>16k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span>28 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><p><img data-src="./image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/SCII3.jpeg"></p><h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p>Welcome to part 3 of the Starcraft AI with Python series. In the previous tutorials we learned the basics of writing an AI agent within Starcraft 2, but we’ve not yet been able to defeat the enemy computer player. In order to do this, we’re going to need to go on the offensive. There are many different types of units that we can go with to play more offensively, but my unit of choice is going to be the Void Ray. This is a good general purpose unit that flies around and shoots a laser beam.</p><span id="more"></span><iframe width="560" height="315" src="https://www.youtube.com/embed/FyhxoHKFIiY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe src="//player.bilibili.com/player.html?aid=937613128&amp;bvid=BV1vT4y1i7mW&amp;cid=557780479&amp;page=1&amp;high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen=""></iframe><p>The Void Ray isn’t necessarily the best unit to use in all situations, but we’re just here to have fun and learn for now.</p><p>In order to build a Void Ray, we need a Stargate. In order to build a Stargate, we need a Cybernetics Core, and for that…we need a Gateway! In order to build the Stargate, as well as the Void Ray units, we’re going to also need “gas.” For gas, we need to build assimilators to extract the vespene gas. To handle for all of this, we’ll again mostly revisit the <code>elif</code> chain. Our first order of business will be to build 2 assimilators. At least on this map, we seem to always start next to 2 vespene gas sources.</p><p>I think Pylons are more important in the order of needs than the assimilators, so right after those, I’ll add:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">elif</span> self.structures(UnitTypeId.ASSIMILATOR).amount &lt;= <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">for</span> nexus <span class="keyword">in</span> self.structures(UnitTypeId.NEXUS):</span><br><span class="line">        vespenes = self.vespene_geyser.closer_than(<span class="number">15</span>, nexus)</span><br><span class="line">        <span class="keyword">for</span> vespene <span class="keyword">in</span> vespenes:</span><br><span class="line">            <span class="keyword">if</span> self.can_afford(UnitTypeId.ASSIMILATOR) <span class="keyword">and</span> <span class="keyword">not</span> self.already_pending(UnitTypeId.ASSIMILATOR):</span><br><span class="line">                <span class="keyword">await</span> self.build(UnitTypeId.ASSIMILATOR, vespene)</span><br></pre></td></tr></tbody></table></figure><p>Take all of my orders with a grain of salt, it may be wise to test out different things, but for now we’ll do this. Later, we could maybe make this dynamic by checking how many vespenes we have close, and simply building assimilators on any unoccupied vespenes. I think the assimilators are more important than the forges and cannons, but I suspect it’s best to hold off on further buildings until we have some more defenses. After our cannons are built, however, we should go ahead and build the Gateway, Cybernetics Core, then Stargate:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># a gateway? this gets us towards cyb core &gt; stargate &gt; void ray</span></span><br><span class="line"><span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.GATEWAY):</span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.GATEWAY):</span><br><span class="line">        <span class="keyword">await</span> self.build(UnitTypeId.GATEWAY, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line"></span><br><span class="line"><span class="comment"># a cyber core? this gets us towards stargate &gt; void ray</span></span><br><span class="line"><span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.CYBERNETICSCORE):</span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.CYBERNETICSCORE):</span><br><span class="line">        <span class="keyword">await</span> self.build(UnitTypeId.CYBERNETICSCORE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line"></span><br><span class="line"><span class="comment"># a stargate? this gets us towards void ray</span></span><br><span class="line"><span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.STARGATE):</span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.STARGATE):</span><br><span class="line">        <span class="keyword">await</span> self.build(UnitTypeId.STARGATE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br></pre></td></tr></tbody></table></figure><p>With all of this, we can build Void Rays, but I would argue that Void Rays are one of our top priorities, and we can also build Void Rays while we do other things. For this reason, I will actually just put this above the if/elif logic, after the nexus definition:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># if we have less than 10 voidrays, build one:</span></span><br><span class="line"><span class="keyword">if</span> self.structures(UnitTypeId.VOIDRAY).amount &lt; <span class="number">10</span> <span class="keyword">and</span> self.can_afford(UnitTypeId.VOIDRAY):</span><br><span class="line">    <span class="keyword">for</span> sg <span class="keyword">in</span> self.structures(UnitTypeId.STARGATE).ready.idle:</span><br><span class="line">        <span class="keyword">if</span> self.can_afford(UnitTypeId.VOIDRAY):</span><br><span class="line">            sg.train(UnitTypeId.VOIDRAY)</span><br></pre></td></tr></tbody></table></figure><p>In this case, I am going to just try to build up to 10 total. Maybe I’ll change this later, I just picked a random number that seemed reasonable. The last thing we need to is control our probe creation. Since we’re building infinite probes, we’ll always be able to build another probe, because a probe takse up 1 supply. A Void Ray costs us 4 supply, so we should probably always leave some room for at least 1 Void Ray. Maybe once we <em>can</em> build Void Rays, we can progressively open this up, or build more pylons to make more supply space. Again, this is all just a first pass of effort, there’s definitely a ton of improvement that could be made.</p><p>We can calc the supply remaining with:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">supply_remaining = self.supply_cap - self.supply_used</span><br></pre></td></tr></tbody></table></figure><p>Then we can just add another <code>and</code> to the if statement for the Pylons:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># leave room to build void rays</span></span><br><span class="line">supply_remaining = self.supply_cap - self.supply_used</span><br><span class="line"><span class="keyword">if</span> nexus.is_idle <span class="keyword">and</span> self.can_afford(UnitTypeId.PROBE) <span class="keyword">and</span> supply_remaining &gt; <span class="number">4</span>:</span><br><span class="line">    nexus.train(UnitTypeId.PROBE)</span><br></pre></td></tr></tbody></table></figure><p>Okay, we’ve added quite a bit up to this point. Here’s our code:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sc2.bot_ai <span class="keyword">import</span> BotAI  <span class="comment"># parent class we inherit from</span></span><br><span class="line"><span class="keyword">from</span> sc2.data <span class="keyword">import</span> Difficulty, Race  <span class="comment"># difficulty for bots, race for the 1 of 3 races</span></span><br><span class="line"><span class="keyword">from</span> sc2.main <span class="keyword">import</span> run_game  <span class="comment"># function that facilitates actually running the agents in games</span></span><br><span class="line"><span class="keyword">from</span> sc2.player <span class="keyword">import</span> Bot, Computer  <span class="comment">#wrapper for whether or not the agent is one of your bots, or a "computer" player</span></span><br><span class="line"><span class="keyword">from</span> sc2 <span class="keyword">import</span> maps  <span class="comment"># maps method for loading maps to play in.</span></span><br><span class="line"><span class="keyword">from</span> sc2.ids.unit_typeid <span class="keyword">import</span> UnitTypeId</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IncrediBot</span>(<span class="title class_ inherited__">BotAI</span>): <span class="comment"># inhereits from BotAI (part of BurnySC2)</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">on_step</span>(<span class="params">self, iteration: <span class="built_in">int</span></span>): <span class="comment"># on_step is a method that is called every step of the game.</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"<span class="subst">{iteration}</span>, n_workers: <span class="subst">{self.workers.amount}</span>, n_idle_workers: <span class="subst">{self.workers.idle.amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"minerals: <span class="subst">{self.minerals}</span>, gas: <span class="subst">{self.vespene}</span>, cannons: <span class="subst">{self.structures(UnitTypeId.PHOTONCANNON).amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"pylons: <span class="subst">{self.structures(UnitTypeId.PYLON).amount}</span>, nexus: <span class="subst">{self.structures(UnitTypeId.NEXUS).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"gateways: <span class="subst">{self.structures(UnitTypeId.GATEWAY).amount}</span>, cybernetics cores: <span class="subst">{self.structures(UnitTypeId.CYBERNETICSCORE).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"stargates: <span class="subst">{self.structures(UnitTypeId.STARGATE).amount}</span>, voidrays: <span class="subst">{self.units(UnitTypeId.VOIDRAY).amount}</span>, supply: <span class="subst">{self.supply_used}</span>/<span class="subst">{self.supply_cap}</span>"</span>)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment"># begin logic:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> self.distribute_workers() <span class="comment"># put idle workers back to work</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.townhalls:  <span class="comment"># do we have a nexus?</span></span><br><span class="line">            nexus = self.townhalls.random  <span class="comment"># select one (will just be one for now)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we have less than 10 voidrays, build one:</span></span><br><span class="line">            <span class="keyword">if</span> self.structures(UnitTypeId.VOIDRAY).amount &lt; <span class="number">10</span> <span class="keyword">and</span> self.can_afford(UnitTypeId.VOIDRAY):</span><br><span class="line">                <span class="keyword">for</span> sg <span class="keyword">in</span> self.structures(UnitTypeId.STARGATE).ready.idle:</span><br><span class="line">                    <span class="keyword">if</span> self.can_afford(UnitTypeId.VOIDRAY):</span><br><span class="line">                        sg.train(UnitTypeId.VOIDRAY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># leave room to build void rays</span></span><br><span class="line">            supply_remaining = self.supply_cap - self.supply_used</span><br><span class="line">            <span class="keyword">if</span> nexus.is_idle <span class="keyword">and</span> self.can_afford(UnitTypeId.PROBE) <span class="keyword">and</span> supply_remaining &gt; <span class="number">4</span>:</span><br><span class="line">                nexus.train(UnitTypeId.PROBE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we dont have *any* pylons, we'll build one close to the nexus.</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.PYLON) <span class="keyword">and</span> self.already_pending(UnitTypeId.PYLON) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=nexus)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.PYLON).amount &lt; <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="comment"># build from the closest pylon towards the enemy</span></span><br><span class="line">                    target_pylon = self.structures(UnitTypeId.PYLON).closest_to(self.enemy_start_locations[<span class="number">0</span>])</span><br><span class="line">                    <span class="comment"># build as far away from target_pylon as possible:</span></span><br><span class="line">                    pos = target_pylon.position.towards(self.enemy_start_locations[<span class="number">0</span>], random.randrange(<span class="number">8</span>, <span class="number">15</span>))</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=pos)</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.ASSIMILATOR).amount &lt;= <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">for</span> nexus <span class="keyword">in</span> self.structures(UnitTypeId.NEXUS):</span><br><span class="line">                    vespenes = self.vespene_geyser.closer_than(<span class="number">15</span>, nexus)</span><br><span class="line">                    <span class="keyword">for</span> vespene <span class="keyword">in</span> vespenes:</span><br><span class="line">                        <span class="keyword">if</span> self.can_afford(UnitTypeId.ASSIMILATOR) <span class="keyword">and</span> <span class="keyword">not</span> self.already_pending(UnitTypeId.ASSIMILATOR):</span><br><span class="line">                            <span class="keyword">await</span> self.build(UnitTypeId.ASSIMILATOR, vespene)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.FORGE):  <span class="comment"># if we don't have a forge:</span></span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.FORGE):  <span class="comment"># and we can afford one:</span></span><br><span class="line">                    <span class="comment"># build one near the Pylon that is closest to the nexus:</span></span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.FORGE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we have less than 3 cannons, let's build some more if possible:</span></span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.FORGE).ready <span class="keyword">and</span> self.structures(UnitTypeId.PHOTONCANNON).amount &lt; <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PHOTONCANNON):  <span class="comment"># can we afford a cannon?</span></span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PHOTONCANNON, near=nexus)  <span class="comment"># build one near the nexus</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># a gateway? this gets us towards cyb core &gt; stargate &gt; void ray</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.GATEWAY):</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.GATEWAY):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.GATEWAY, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># a cyber core? this gets us towards stargate &gt; void ray</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.CYBERNETICSCORE):</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.CYBERNETICSCORE):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.CYBERNETICSCORE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># a stargate? this gets us towards void ray</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.STARGATE):</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.STARGATE):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.STARGATE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> self.can_afford(UnitTypeId.NEXUS):  <span class="comment"># can we afford one?</span></span><br><span class="line">                <span class="keyword">await</span> self.expand_now()  <span class="comment"># build one!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">run_game(  <span class="comment"># run_game is a function that runs the game.</span></span><br><span class="line">    maps.get(<span class="string">"2000AtmospheresAIE"</span>), <span class="comment"># the map we are playing on</span></span><br><span class="line">    [Bot(Race.Protoss, IncrediBot()), <span class="comment"># runs our coded bot, protoss race, and we pass our bot object </span></span><br><span class="line">     Computer(Race.Zerg, Difficulty.Hard)], <span class="comment"># runs a pre-made computer agent, zerg race, with a hard difficulty.</span></span><br><span class="line">    realtime=<span class="literal">False</span>, <span class="comment"># When set to True, the agent is limited in how long each step can take to process.</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure><p>Running this, things actually look fairly decent. We wind up building 2 Starbases, and a few extra Void Rays, but we are definitely able to hold off the enemy for quite some time with this group:</p><p><img data-src="./image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/void-rays-defense.jpg"></p><p>So we’ve definitely got a strong defense when needed with these Void Rays, but that’s not the reason we built them. We built these for battle! For the extra buildings, we can add a pending building check, same for Void Rays. It’s probably not a huge mistake to have a couple Starbases, since that means we can build Void Rays faster, but it would probably be a waste to have multiple Cybernetics Cores or something.</p><p>But, before I address that, I want to see an attack. To command this force, I propose we do it outside of the Nexus check. Our army of Void Rays does not need a Nexus to attack, so we can have their commands sit outside of the Nexus check. Void Rays also can’t build a Nexus back, so it’s fairly irrelevant. For now, in order to attack, I think it’s best we attack with more than just 1 Void Ray. I really don’t know if that’s true, and I’ll just arbitrarily set the number required for attack: 4.</p><p>The next question is: where do we attack?</p><p>We have access to some data about our game, as noted <a target="_blank" rel="noopener" href="https://burnysc2.github.io/python-sc2/docs/text_files/introduction.html#available-information-in-the-game">here</a>. We can see that we can access enemy units, enemy structures, and the enemy start location. If we’ve seen enemy units or buildings, then we might as well target those first. If we don’t know where any enemy units are, then let’s head towards the enemy’s starting location, because we’ll probably find some enemies there!</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># if we have more than 3 voidrays, let's attack!</span></span><br><span class="line"><span class="keyword">if</span> self.units(UnitTypeId.VOIDRAY).amount &gt;= <span class="number">3</span>:</span><br><span class="line">    <span class="keyword">if</span> self.enemy_units:</span><br><span class="line">        <span class="keyword">for</span> vr <span class="keyword">in</span> self.units(UnitTypeId.VOIDRAY).idle:</span><br><span class="line">            vr.attack(random.choice(self.enemy_units))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span> self.enemy_structures:</span><br><span class="line">        <span class="keyword">for</span> vr <span class="keyword">in</span> self.units(UnitTypeId.VOIDRAY).idle:</span><br><span class="line">            vr.attack(random.choice(self.enemy_structures))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># otherwise attack enemy starting position</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> vr <span class="keyword">in</span> self.units(UnitTypeId.VOIDRAY).idle:</span><br><span class="line">            vr.attack(self.enemy_start_locations[<span class="number">0</span>])</span><br></pre></td></tr></tbody></table></figure><p>Now, full code is:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sc2.bot_ai <span class="keyword">import</span> BotAI  <span class="comment"># parent class we inherit from</span></span><br><span class="line"><span class="keyword">from</span> sc2.data <span class="keyword">import</span> Difficulty, Race  <span class="comment"># difficulty for bots, race for the 1 of 3 races</span></span><br><span class="line"><span class="keyword">from</span> sc2.main <span class="keyword">import</span> run_game  <span class="comment"># function that facilitates actually running the agents in games</span></span><br><span class="line"><span class="keyword">from</span> sc2.player <span class="keyword">import</span> Bot, Computer  <span class="comment">#wrapper for whether or not the agent is one of your bots, or a "computer" player</span></span><br><span class="line"><span class="keyword">from</span> sc2 <span class="keyword">import</span> maps  <span class="comment"># maps method for loading maps to play in.</span></span><br><span class="line"><span class="keyword">from</span> sc2.ids.unit_typeid <span class="keyword">import</span> UnitTypeId</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IncrediBot</span>(<span class="title class_ inherited__">BotAI</span>): <span class="comment"># inhereits from BotAI (part of BurnySC2)</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">on_step</span>(<span class="params">self, iteration: <span class="built_in">int</span></span>): <span class="comment"># on_step is a method that is called every step of the game.</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"<span class="subst">{iteration}</span>, n_workers: <span class="subst">{self.workers.amount}</span>, n_idle_workers: <span class="subst">{self.workers.idle.amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"minerals: <span class="subst">{self.minerals}</span>, gas: <span class="subst">{self.vespene}</span>, cannons: <span class="subst">{self.structures(UnitTypeId.PHOTONCANNON).amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"pylons: <span class="subst">{self.structures(UnitTypeId.PYLON).amount}</span>, nexus: <span class="subst">{self.structures(UnitTypeId.NEXUS).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"gateways: <span class="subst">{self.structures(UnitTypeId.GATEWAY).amount}</span>, cybernetics cores: <span class="subst">{self.structures(UnitTypeId.CYBERNETICSCORE).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"stargates: <span class="subst">{self.structures(UnitTypeId.STARGATE).amount}</span>, voidrays: <span class="subst">{self.units(UnitTypeId.VOIDRAY).amount}</span>, supply: <span class="subst">{self.supply_used}</span>/<span class="subst">{self.supply_cap}</span>"</span>)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment"># begin logic:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> self.distribute_workers() <span class="comment"># put idle workers back to work</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.townhalls:  <span class="comment"># do we have a nexus?</span></span><br><span class="line">            nexus = self.townhalls.random  <span class="comment"># select one (will just be one for now)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we have less than 10 voidrays, build one:</span></span><br><span class="line">            <span class="keyword">if</span> self.structures(UnitTypeId.VOIDRAY).amount &lt; <span class="number">10</span> <span class="keyword">and</span> self.can_afford(UnitTypeId.VOIDRAY):</span><br><span class="line">                <span class="keyword">for</span> sg <span class="keyword">in</span> self.structures(UnitTypeId.STARGATE).ready.idle:</span><br><span class="line">                    <span class="keyword">if</span> self.can_afford(UnitTypeId.VOIDRAY):</span><br><span class="line">                        sg.train(UnitTypeId.VOIDRAY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># leave room to build void rays</span></span><br><span class="line">            supply_remaining = self.supply_cap - self.supply_used</span><br><span class="line">            <span class="keyword">if</span> nexus.is_idle <span class="keyword">and</span> self.can_afford(UnitTypeId.PROBE) <span class="keyword">and</span> supply_remaining &gt; <span class="number">4</span>:</span><br><span class="line">                nexus.train(UnitTypeId.PROBE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we dont have *any* pylons, we'll build one close to the nexus.</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.PYLON) <span class="keyword">and</span> self.already_pending(UnitTypeId.PYLON) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=nexus)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.PYLON).amount &lt; <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="comment"># build from the closest pylon towards the enemy</span></span><br><span class="line">                    target_pylon = self.structures(UnitTypeId.PYLON).closest_to(self.enemy_start_locations[<span class="number">0</span>])</span><br><span class="line">                    <span class="comment"># build as far away from target_pylon as possible:</span></span><br><span class="line">                    pos = target_pylon.position.towards(self.enemy_start_locations[<span class="number">0</span>], random.randrange(<span class="number">8</span>, <span class="number">15</span>))</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=pos)</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.ASSIMILATOR).amount &lt;= <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">for</span> nexus <span class="keyword">in</span> self.structures(UnitTypeId.NEXUS):</span><br><span class="line">                    vespenes = self.vespene_geyser.closer_than(<span class="number">15</span>, nexus)</span><br><span class="line">                    <span class="keyword">for</span> vespene <span class="keyword">in</span> vespenes:</span><br><span class="line">                        <span class="keyword">if</span> self.can_afford(UnitTypeId.ASSIMILATOR) <span class="keyword">and</span> <span class="keyword">not</span> self.already_pending(UnitTypeId.ASSIMILATOR):</span><br><span class="line">                            <span class="keyword">await</span> self.build(UnitTypeId.ASSIMILATOR, vespene)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.FORGE):  <span class="comment"># if we don't have a forge:</span></span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.FORGE):  <span class="comment"># and we can afford one:</span></span><br><span class="line">                    <span class="comment"># build one near the Pylon that is closest to the nexus:</span></span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.FORGE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we have less than 3 cannons, let's build some more if possible:</span></span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.FORGE).ready <span class="keyword">and</span> self.structures(UnitTypeId.PHOTONCANNON).amount &lt; <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PHOTONCANNON):  <span class="comment"># can we afford a cannon?</span></span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PHOTONCANNON, near=nexus)  <span class="comment"># build one near the nexus</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># a gateway? this gets us towards cyb core &gt; stargate &gt; void ray</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.GATEWAY):</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.GATEWAY):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.GATEWAY, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># a cyber core? this gets us towards stargate &gt; void ray</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.CYBERNETICSCORE):</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.CYBERNETICSCORE):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.CYBERNETICSCORE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># a stargate? this gets us towards void ray</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.STARGATE):</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.STARGATE):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.STARGATE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> self.can_afford(UnitTypeId.NEXUS):  <span class="comment"># can we afford one?</span></span><br><span class="line">                <span class="keyword">await</span> self.expand_now()  <span class="comment"># build one!</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        <span class="comment"># if we have more than 3 voidrays, let's attack!</span></span><br><span class="line">        <span class="keyword">if</span> self.units(UnitTypeId.VOIDRAY).amount &gt;= <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">if</span> self.enemy_units:</span><br><span class="line">                <span class="keyword">for</span> vr <span class="keyword">in</span> self.units(UnitTypeId.VOIDRAY).idle:</span><br><span class="line">                    vr.attack(random.choice(self.enemy_units))</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">elif</span> self.enemy_structures:</span><br><span class="line">                <span class="keyword">for</span> vr <span class="keyword">in</span> self.units(UnitTypeId.VOIDRAY).idle:</span><br><span class="line">                    vr.attack(random.choice(self.enemy_structures))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># otherwise attack enemy starting position</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> vr <span class="keyword">in</span> self.units(UnitTypeId.VOIDRAY).idle:</span><br><span class="line">                    vr.attack(self.enemy_start_locations[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">run_game(  <span class="comment"># run_game is a function that runs the game.</span></span><br><span class="line">    maps.get(<span class="string">"2000AtmospheresAIE"</span>), <span class="comment"># the map we are playing on</span></span><br><span class="line">    [Bot(Race.Protoss, IncrediBot()), <span class="comment"># runs our coded bot, protoss race, and we pass our bot object </span></span><br><span class="line">     Computer(Race.Zerg, Difficulty.Hard)], <span class="comment"># runs a pre-made computer agent, zerg race, with a hard difficulty.</span></span><br><span class="line">    realtime=<span class="literal">False</span>, <span class="comment"># When set to True, the agent is limited in how long each step can take to process.</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure><p>Running this, we make some void rays and can see them promptly go to the enemy starting location across the map, wreaking immediate havoc on the enemy:</p><iframe src="//player.bilibili.com/player.html?aid=510002180&amp;bvid=BV1Bu411q7bi&amp;cid=557729934&amp;page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen=""></iframe><p>The enemy does propose to surrender, but we don’t accept this. Eventually:</p><p><img data-src="./image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/void-ray-victory.jpg"></p><p>Running this a few times seems to yield similar results. It seems like Void Rays do pretty well here, at least up to the Hard Zerg computer. When poking around, I saw that Void Rays apparently don’t do well against terran. Let’s change the computer to Terran race instead:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">run_game(  <span class="comment"># run_game is a function that runs the game.</span></span><br><span class="line">    maps.get(<span class="string">"2000AtmospheresAIE"</span>), <span class="comment"># the map we are playing on</span></span><br><span class="line">    [Bot(Race.Protoss, IncrediBot()), <span class="comment"># runs our coded bot, protoss race, and we pass our bot object </span></span><br><span class="line">     Computer(Race.Terran, Difficulty.Hard)], <span class="comment"># runs a pre-made computer agent, zerg race, with a hard difficulty.</span></span><br><span class="line">    realtime=<span class="literal">False</span>, <span class="comment"># When set to True, the agent is limited in how long each step can take to process.</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure><p>While the fight definitely looked a bit harder, it certainly wasn’t as swift of a defeat and we lost more Void Rays, we still won. Running again, the victory seems to come even easier:</p><p><img data-src="./image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/void-rays-vs-terran.jpg"></p><p>It does seem like the Terrans can handle Void Rays better, and that probably harder bots will require a better strategy, but I’d say this is a pretty good start.</p></div><div class="popular-posts-header">Related Posts</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/1c1975a5.html" rel="bookmark">Defending Ourselves</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/ed318fdd.html" rel="bookmark">Introduction</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/595d9f82.html" rel="bookmark">Simple StarCraft 2 Bot Template to Get Started</a></div></li></ul><footer class="post-footer"><div class="post-tags"><a href="/tags/Python/" rel="tag"># Python</a> <a href="/tags/StarCraft2/" rel="tag"># StarCraft2</a></div><div class="post-nav"><div class="post-nav-item"><a href="/archives/1c1975a5.html" rel="prev" title="Defending Ourselves"><i class="fa fa-chevron-left"></i> Defending Ourselves</a></div><div class="post-nav-item"><a href="/archives/41c38174.html" rel="next" title="试验性质的互动电影--Death Come True">试验性质的互动电影--Death Come True <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:e}=CONFIG.comments;if(CONFIG.comments.storage&&(e=localStorage.getItem("comments_active")||e),e){let t=document.querySelector(`a[href="#comment-${e}"]`);t&&t.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">引言</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Yousazoe" src="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><p class="site-author-name" itemprop="name">Yousazoe</p><div class="site-description" itemprop="description">done is better than perfect</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">278</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">44</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">70</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:zoeyousa@gmail.com" title="E-Mail → mailto:zoeyousa@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://github.com/Yousazoe" title="GitHub → https://github.com/Yousazoe" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://twitter.com/YousaZoe" title="Twitter → https://twitter.com/YousaZoe" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.weibo.com/6034231696/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo&amp;is_all=1" title="Weibo → https://www.weibo.com/6034231696/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo&amp;is_all=1" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://steamcommunity.com/profiles/76561198856466228/" title="Steam → https://steamcommunity.com/profiles/76561198856466228/" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.chess.com/member/yousazoe" title="Chess → https://www.chess.com/member/yousazoe" rel="noopener" target="_blank"><i class="fa fa-chess-pawn fa-fw"></i></a> </span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml"><i class="fa fa-rss fa-fw"></i></a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="./image/loading.gif" data-original="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="twopeople"><div class="container" style="height:200px"><canvas class="illo" width="800" height="800" style="max-width:200px;max-height:200px;touch-action:none;width:640px;height:640px"></canvas></div><script src="https://img.yousazoe.top/js/twopeople1.js"></script><script src="https://img.yousazoe.top/js/zdog.dist.js"></script><script id="rendered-js" src="https://img.yousazoe.top/js/twopeople.js"></script><style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style></div><div class="cc-license animated" itemprop="sponsor"><link rel="preconnect" href="https://www.netlify.com"><span class="exturl cc-opacity" title="Deploy with Netlify → https://www.netlify.com" data-url="aHR0cHM6Ly93d3cubmV0bGlmeS5jb20="><img width="80" src="./image/loading.gif" data-original="https://www.netlify.com/img/global/badges/netlify-dark.svg" alt="Netlify"></span></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="translate-style">繁/简：<a id="translateLink" href="javascript:translatePage();">繁体</a></div><script type="text/javascript" src="/js/tw_cn.js"></script><script type="text/javascript">var defaultEncoding=2,translateDelay=0,cookieDomain="https://tding.top/",msgToTraditionalChinese="繁体",msgToSimplifiedChinese="简体",translateButtonId="translateLink";translateInitilization()</script><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">晋ICP备2021009930号 </a><img src="./image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/备案图标.png" style="display:inline-block"></div><div class="copyright">© 2020 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Yousazoe</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="Symbols count total">4.1m</span></div><div class="powered-by"><span><a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img src="./image/loading.gif" data-original="https://cdn.jsdelivr.net/gh/YukiNoUta/cdn-static@main/blog/svg/upyun.svg" width="53" height="18" style="fill:currentColor;display:inline-block"></a></span><span class="post-meta-divider">|</span>今早雾霾蔽日，但是不要害怕，太阳依旧在云端</div><div class="busuanzi-count"><script data-pjax="" async="" src="js/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="//unpkg.com/animejs@3.1.0/lib/anime.min.js"></script><script src="//npm.elemecdn.com/pjax/pjax.min.js"></script><script src="//lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="//unpkg.com/lozad@1.16.0/dist/lozad.min.js"></script><script src="//lib.baomitu.com/pangu/4.0.7/pangu.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
    $(document).ready(function () {

    if(location.href.indexOf("#reloaded")==-1){
        location.href=location.href+"#reloaded";
        location.reload();
    }
}）
#在这后面可以加入程序的其他代码  


  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });

  
  NexT.boot.refresh();
  
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  
  NexT.utils.updateSidebarPosition();
});</script><script defer="" src="//img.yousazoe.top/js/three.min.js"></script><script defer="" src="//img.yousazoe.top/js/caidai.js"></script><script data-pjax="">!function(){var e,t,o,n,r=document.getElementsByTagName("link");if(0<r.length)for(i=0;i<r.length;i++)"canonical"==r[i].rel.toLowerCase()&&r[i].href&&(e=r[i].href);t=(e||window.location.protocol).split(":")[0],e=e||window.location.href,window,o=e,n=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(o)||(t="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",n?(t+="?r="+encodeURIComponent(document.referrer),o&&(t+="&l="+o)):o&&(t+="?l="+o),(new Image).src=t)}()</script><script src="/js/local-search.js"></script><script data-pjax="">document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),r=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script data-pjax="">document.querySelectorAll("pre.mermaid").length&&NexT.utils.getScript("//lib.baomitu.com/mermaid/8.4.8/mermaid.min.js",()=>{mermaid.initialize({theme:"forest",logLevel:3,flowchart:{curve:"linear"},gantt:{axisFormat:"%m/%d/%Y"},sequence:{actorMargin:50}})},window.mermaid)</script><div id="pjax"></div><script type="text/javascript" src="/js/cursor/fireworks.js"></script><script src="https://img.yousazoe.top/live2dw/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/hijiki.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!0},log:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:3,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},t.src!==o&&(i.src=o)}()}o(),n.addEventListener("scroll",function(){var t=o,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script type="text/javascript" charset="utf-8" src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script></body></html>