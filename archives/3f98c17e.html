<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="mask-icon" href="/images/favicon.ico" color="#222"><meta name="google-site-verification" content="35AYyqm-wpmGmXtkn-vQMrk7AkFl1Do55uHdlLLLT38"><meta name="baidu-site-verification" content="slBbq5f8WxljPytW"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/5.15.4/css/all.min.css"><link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//unpkg.com/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//unpkg.com/pace-js@1.2.4/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"yousazoe.top",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!0,comments:{style:"tabs",active:null,storage:!0,lazyload:!0,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:3,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="å¼•è¨€æœ¬èŠ‚çš„ä¸»é¢˜æ˜¯æ™¯æ·±ã€‚æˆ‘ä»¬å°†æ·»åŠ å¯æ§ç›¸æœºå…‰åœˆï¼Œå¼•å…¥æ™¯æ·±ã€‚"><meta property="og:type" content="article"><meta property="og:title" content="A Gentle Introduction to DirectX Raytracing 8"><meta property="og:url" content="https://yousazoe.top/archives/3f98c17e.html"><meta property="og:site_name" content="Fl0w3r"><meta property="og:description" content="å¼•è¨€æœ¬èŠ‚çš„ä¸»é¢˜æ˜¯æ™¯æ·±ã€‚æˆ‘ä»¬å°†æ·»åŠ å¯æ§ç›¸æœºå…‰åœˆï¼Œå¼•å…¥æ™¯æ·±ã€‚"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Tutor08-Output.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/300px-Lens1.svg.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/320px-Aperture_diagram.svg.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Tutor08-Output-20220110172811499.png"><meta property="article:published_time" content="2022-01-10T09:24:08.000Z"><meta property="article:modified_time" content="2024-09-26T08:35:13.411Z"><meta property="article:author" content="Yousazoe"><meta property="article:tag" content="Computer Graphics"><meta property="article:tag" content="Ray Tracing"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Tutor08-Output.png"><link rel="canonical" href="https://yousazoe.top/archives/3f98c17e.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>A Gentle Introduction to DirectX Raytracing 8 | Fl0w3r</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Fl0w3r" type="application/atom+xml"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Fl0w3r</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">carpe diem</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-address-card fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-paperclip fa-fw"></i>Links</a></li><li class="menu-item menu-item-photos"><a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>Photos</a></li><li class="menu-item menu-item-artitalk"><a href="/artitalk/" rel="section"><i class="fa fa-calendar fa-fw"></i>Artitalk</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-document"><a href="/docs/" rel="section"><i class="fas fa-book fa-fw"></i>Document</a></li><li class="menu-item menu-item-qexoadmin"><a href="https://blog-yousazoe-qexo.vercel.app/" rel="noopener" target="_blank"><i class="fa fa-database fa-fw"></i>QexoAdmin</a></li><li class="menu-item menu-item-gametracker"><a href="https://yousazoe.notion.site/yousazoe/b05999823bd14b57a7a6cd81fba1a1af?v=21c3398e0bdb429c9b8157b7bf12ff6a" rel="noopener" target="_blank"><i class="fas fa-trophy fa-fw"></i>GameTracker</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://yousazoe.top/archives/3f98c17e.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><meta itemprop="name" content="Yousazoe"><meta itemprop="description" content="done is better than perfect"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Fl0w3r"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">A Gentle Introduction to DirectX Raytracing 8</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-01-10 17:24:08" itemprop="dateCreated datePublished" datetime="2022-01-10T17:24:08+08:00">2022-01-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/%E5%85%89%E7%BA%BF%E8%BF%BD%E8%B8%AA-Ray-Tracing/" itemprop="url" rel="index"><span itemprop="name">å…‰çº¿è¿½è¸ª (Ray Tracing)</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="fas fa-pen"></i></span><span>7.6k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span>14 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Tutor08-Output.png"></p><h3 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h3><p>æœ¬èŠ‚çš„ä¸»é¢˜æ˜¯æ™¯æ·±ã€‚æˆ‘ä»¬å°†æ·»åŠ å¯æ§ç›¸æœºå…‰åœˆï¼Œå¼•å…¥æ™¯æ·±ã€‚</p><span id="more"></span><blockquote><p>In <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">Tutorial 7</a>, we added random jitter to the camera position to allow antialiasing by accumulating samples temporally over multiple frames. This tutorial modifies our <code>RayTracedGBufferPass</code> from <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor4/tutorial04.md.html">Tutorial 4</a> to use a simple <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Thin_lens">thin lens camera model</a>. Each pixel randomly selects the camera origin somewhere on the lens of this camera. Temporally accumulating these random camera origins over multiple frames allows us to model dynamic <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Depth_of_field">depth of field</a>.</p></blockquote><p>åœ¨<a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">æ•™ç¨‹7</a>ä¸­ï¼Œæˆ‘ä»¬åœ¨ç›¸æœºä½ç½®æ·»åŠ äº†éšæœºæŠ–åŠ¨ï¼Œé€šè¿‡åœ¨å¤šä¸ªå¸§ä¸Šä¸´æ—¶ç§¯ç´¯æ ·æœ¬æ¥å…è®¸æŠ—é”¯é½¿ã€‚æœ¬æ•™ç¨‹ä¿®æ”¹äº†<a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor4/tutorial04.md.html">æ•™ç¨‹4</a>ä¸­çš„ <code>RayTracedGBufferPass</code> ä»¥ä½¿ç”¨ç®€å•çš„<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Thin_lens">é’ˆå­”ç›¸æœºæ¨¡å‹</a>ã€‚æ¯ä¸ªåƒç´ éšæœºé€‰æ‹©ç›¸æœºé•œå¤´ä¸ŠæŸå¤„çš„ç›¸æœºåŸç‚¹ã€‚åœ¨å¤šä¸ªå¸§ä¸Šä¸´æ—¶ç´¯ç§¯è¿™äº›éšæœºç›¸æœºåŸç‚¹ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿå¯¹åŠ¨æ€<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Depth_of_field">æ™¯æ·±</a>è¿›è¡Œå»ºæ¨¡ã€‚</p><h3 id="Our-Antialised-Rendering-Pipeline"><a href="#Our-Antialised-Rendering-Pipeline" class="headerlink" title="Our Antialised Rendering Pipeline"></a>Our Antialised Rendering Pipeline</h3><blockquote><p>If you open up <code>Tutor08-ThinLensCamera.cpp</code>, you will find our new pipeline combines a new <code>ThinLensGBufferPass</code>, the <code>AmbientOcclusionPass</code> from <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor5/tutorial05.md.html">Tutorial 5</a>, and the <code>SimpleAccumulationPass</code> from <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor6/tutorial06.md.html">Tutorial 6</a>.</p></blockquote><p>å¦‚æœæ‚¨æ‰“å¼€ <code>Tutor08-ThinLensCamera.cpp</code>ï¼Œæ‚¨ä¼šå‘ç°æˆ‘ä»¬çš„æ–°ç®¡é“ç»“åˆäº†<a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor5/tutorial05.md.html">æ•™ç¨‹5</a> ä¸­çš„ <code>ThinLensGBufferPass</code>ã€<code>AmbientOcclusionPass</code> å’Œ <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor6/tutorial06.md.html">æ•™ç¨‹6</a> ä¸­çš„<code>SimpleAccumulationPass</code> ï¼š</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// Create our rendering pipeline</span></span><br><span class="line">RenderingPipeline *pipeline = <span class="keyword">new</span> <span class="built_in">RenderingPipeline</span>();</span><br><span class="line">pipeline-&gt;<span class="built_in">setPass</span>(<span class="number">0</span>, ThinLensGBufferPass::<span class="built_in">create</span>());   </span><br><span class="line">pipeline-&gt;<span class="built_in">setPass</span>(<span class="number">1</span>, AmbientOcclusionPass::<span class="built_in">create</span>());    </span><br><span class="line">pipeline-&gt;<span class="built_in">setPass</span>(<span class="number">2</span>, </span><br><span class="line">   SimpleAccumulationPass::<span class="built_in">create</span>(ResourceManager::kOutputChannel)); </span><br></pre></td></tr></tbody></table></figure><blockquote><p>This <code>ThinLensGBufferPass</code> builds on the <code>RayTracedGBufferPass</code> from <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor4/tutorial04.md.html">Tutorial 4</a> but adds our new per-pixel random camera origin. Essentially, camera jitter from <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">Tutorial 7</a> perturbs the camera ray <strong>direction</strong>; a thin lens model also perturbs the camera <strong>origin</strong>.</p></blockquote><p>æ­¤ <code>ThinLensGBufferPass</code> åŸºäº<a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor4/tutorial04.md.html">æ•™ç¨‹ 4</a>ä¸­çš„ <code>RayTracedGBufferPass</code> æ„å»ºï¼Œä½†æ·»åŠ äº†æˆ‘ä»¬æ–°çš„æ¯åƒç´ éšæœºç›¸æœºåŸç‚¹ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œ<a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">æ•™ç¨‹7</a> ä¸­çš„ç›¸æœºæŠ–åŠ¨ä¼šæ‰°ä¹±ç›¸æœºå…‰çº¿<strong>æ–¹å‘</strong>ï¼›è–„é€é•œæ¨¡å‹ä¹Ÿæ‰°ä¹±äº†ç›¸æœºçš„<strong>åŸç‚¹</strong>ã€‚</p><blockquote><p>In order to combine antialiasing, our thin lens camera model, and to allow the user to toggle them both on and off, the <code>ThinLensGBufferPass</code> also reuses the random jittering code from <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">Tutorial 7</a>.</p></blockquote><p>ä¸ºäº†ç»“åˆæˆ‘ä»¬çš„è–„é€é•œç›¸æœºæ¨¡å‹çš„æŠ—é”¯é½¿ï¼Œå¹¶å…è®¸ç”¨æˆ·åŒæ—¶æ‰“å¼€å’Œå…³é—­å®ƒä»¬ï¼Œ<code>ThinLensGBufferPass</code> è¿˜é‡ç”¨äº† <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">æ•™ç¨‹7</a> ä¸­çš„éšæœºæŠ–åŠ¨ä»£ç ã€‚.</p><h3 id="Setting-up-Our-Thin-Lens"><a href="#Setting-up-Our-Thin-Lens" class="headerlink" title="Setting up Our Thin Lens"></a>Setting up Our Thin Lens</h3><blockquote><p>Continue by looking in <code>ThinLensGBufferPass.h</code>. The key changes are the introduction of a number of variables related to lens parameters:</p></blockquote><p>ç»§ç»­æŸ¥çœ‹ <code>ThinLensGBufferPass.h</code>ã€‚ä¸»è¦å˜åŒ–æ˜¯å¼•å…¥äº†è®¸å¤šä¸é•œå¤´å‚æ•°ç›¸å…³çš„å˜é‡ï¼š</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">bool</span>      mUseThinLens = <span class="literal">false</span>;  <span class="comment">// Currently using thin lens?  (Or pinhole?)</span></span><br><span class="line"><span class="type">float</span>     mFNumber = <span class="number">32.0f</span>;      <span class="comment">// The f-number of our thin lens</span></span><br><span class="line"><span class="type">float</span>     mFocalLength = <span class="number">1.0f</span>;   <span class="comment">// The distance to our focal plane</span></span><br><span class="line"><span class="type">float</span>     mLensRadius;           <span class="comment">// The camera aperature.  (Computed) </span></span><br></pre></td></tr></tbody></table></figure><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/300px-Lens1.svg.png"></p><blockquote><p><code>mUseThinLens</code> is a user-controllable variable in the GUI that allows toggling camera jitter. <code>mFNumber</code> and <code>mFocalLength</code> are the user-controllable parameters for the thin lens. <code>mFNumber</code> controls the virtual <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/F-number">f-number</a>. <code>mFocalLength</code> controls our cameraâ€™s <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Focal_length">focal length</a>, which is the distance from the camera where all rays contributing to a pixel converge.</p></blockquote><p><code>mUseThinLens</code> æ˜¯ GUI ä¸­ç”¨æˆ·å¯æ§åˆ¶çš„å˜é‡ï¼Œå…è®¸åˆ‡æ¢ç›¸æœºæŠ–åŠ¨ã€‚<code>mFNumber</code> å’Œ<code>mFocalLength</code> æ˜¯è–„é€é•œæ¨¡å‹ä¸­ç”¨æˆ·å¯æ§å‚æ•°ã€‚<code>mFNumber</code>æ§åˆ¶è™šæ‹Ÿ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/F-number">é€šå…‰å­”å¾„</a>ã€‚<code>mFocalLength</code>æ§åˆ¶ç›¸æœºçš„<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Focal_length">ç„¦è·</a>ï¼Œè¿™æ˜¯ä¸ç›¸æœºä¹‹é—´çš„è·ç¦»ï¼Œå…¶ä¸­æ‰€æœ‰å…‰çº¿éƒ½èšé›†åœ¨ä¸€ä¸ªåƒç´ ä¸Šã€‚</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/320px-Aperture_diagram.svg.png"></p><blockquote><p>Since we define default values for all our thin lens parameters in the header file, there are no camera-specific additions to our <code>ThinLensGBufferPass::initialize()</code> method, so we move on to the changes required in <code>ThinLensGBufferPass::execute()</code></p></blockquote><p>ç”±äºæˆ‘ä»¬åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰äº†æ‰€æœ‰è–„é•œå¤´å‚æ•°çš„é»˜è®¤å€¼ï¼Œå› æ­¤æˆ‘ä»¬çš„ <code>ThinLensGBufferPass::initialize()</code> æ–¹æ³•ä¸­æ²¡æœ‰ç‰¹å®šäºç›¸æœºçš„æ·»åŠ ï¼Œå› æ­¤æˆ‘ä»¬ç»§ç»­è¿›è¡Œ <code>ThinLensGBufferPass::execute()</code> ä¸­æ‰€éœ€çš„æ›´æ”¹ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ThinLensGBufferPass::execute</span><span class="params">(RenderContext::SharedPtr pRenderContext)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// Compute lens radius based on our user-exposed controls</span></span><br><span class="line">  mLensRadius = mFocalLength / (<span class="number">2.0f</span> * mFNumber);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Specify our HLSL variables for our thin lens</span></span><br><span class="line">  <span class="keyword">auto</span> rayGenVars = mpRays-&gt;<span class="built_in">getRayGenVars</span>();</span><br><span class="line">  rayGenVars[<span class="string">"RayGenCB"</span>][<span class="string">"gLensRadius"</span>]  = mUseThinLens ? mLensRadius : <span class="number">0.0f</span>;</span><br><span class="line">  rayGenVars[<span class="string">"RayGenCB"</span>][<span class="string">"gFocalLen"</span>]    = mFocalLength;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Compute our camera jitter</span></span><br><span class="line">  <span class="type">float</span> xJitter = mUseJitter ? <span class="built_in">mRngDist</span>(mRng) : <span class="number">0.0f</span>;</span><br><span class="line">  <span class="type">float</span> yJitter = mUseJitter ? <span class="built_in">mRngDist</span>(mRng) : <span class="number">0.0f</span>;</span><br><span class="line">  rayGenVars[<span class="string">"RayGenCB"</span>][<span class="string">"gPixelJitter"</span>] = <span class="built_in">vec2</span>(xOff, yOff);</span><br><span class="line">  ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><blockquote><p>The first addition computes <code>mLensRadius</code> based on our user-specified <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/F-number">focal length and f-number</a>. We then pass down our thin lens parameters to our DirectX ray generation shader, where weâ€™ll use it to determine what rays to shoot from our camera. Note: A thin lens camera model degenerates to a pinhole camera if the lens radius is set to zero, so if the user chooses a pinhole camera the logic need not change.</p></blockquote><p>ç¬¬ä¸€ä¸ªåŠ æ³•æ ¹æ®æˆ‘ä»¬ç”¨æˆ·æŒ‡å®šçš„ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/F-number">ç„¦è·å’Œé€šå…‰å­”è·</a>è®¡ç®— <code>mLensRadius</code>ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è–„é•œå¤´å‚æ•°ä¼ é€’åˆ° DirectX å…‰çº¿ç”Ÿæˆç€è‰²å™¨ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥ç¡®å®šè¦ä»ç›¸æœºæ‹æ‘„å“ªäº›å…‰çº¿ã€‚æ³¨æ„ï¼šå¦‚æœé•œå¤´åŠå¾„è®¾ç½®ä¸ºé›¶ï¼Œåˆ™è–„é•œå¤´ç›¸æœºå‹å·ä¼šé€€åŒ–ä¸ºé’ˆå­”ç›¸æœºï¼Œå› æ­¤å¦‚æœç”¨æˆ·é€‰æ‹©é’ˆå­”ç›¸æœºï¼Œé€»è¾‘æ— éœ€æ›´æ”¹ã€‚</p><blockquote><p>We also pass down a random camera jitter to antialias geometry that is focus. This is slightly different that when rasterizing in <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">Tutorial 7</a>, where Falcor utilities handled everything to jitter the camera. Here we pass the pixel jitter down to our ray generation shader, where weâ€™ll take also this jitter into account when tracing our rays.</p></blockquote><p>æˆ‘ä»¬è¿˜å°†éšæœºçš„ç›¸æœºæŠ–åŠ¨ä¼ é€’ç»™ä½œä¸ºç„¦ç‚¹çš„æŠ—é”¯é½¿å‡ ä½•å›¾å½¢ã€‚è¿™ä¸æ•™ç¨‹ 7 ä¸­çš„æ …æ ¼åŒ–ç•¥æœ‰ä¸åŒï¼Œåœ¨ <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">æ•™ç¨‹ 7</a> ä¸­ï¼ŒFalcor å®ç”¨ç¨‹åºå¤„ç†æ‰€æœ‰å†…å®¹ä»¥ä½¿ç›¸æœºæŠ–åŠ¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†åƒç´ æŠ–åŠ¨ä¼ é€’åˆ°å…‰çº¿ç”Ÿæˆç€è‰²å™¨ï¼Œåœ¨è·Ÿè¸ªå…‰çº¿æ—¶ï¼Œæˆ‘ä»¬è¿˜å°†è€ƒè™‘è¿™ç§æŠ–åŠ¨ã€‚</p><h3 id="DirectX-Ray-Generation-for-Jittered-Thin-Lens-Camera-Rays"><a href="#DirectX-Ray-Generation-for-Jittered-Thin-Lens-Camera-Rays" class="headerlink" title="DirectX Ray Generation for Jittered, Thin-Lens Camera Rays"></a>DirectX Ray Generation for Jittered, Thin-Lens Camera Rays</h3><blockquote><p>The final step in this tutorial is updating our G-bufferâ€™s ray generation to perturb our camera origin and ray directions:</p></blockquote><p>æœ¬æ•™ç¨‹çš„æœ€åä¸€æ­¥æ˜¯æ›´æ–° G ç¼“å†²åŒºçš„å…‰çº¿ç”Ÿæˆï¼Œä»¥æ‰°åŠ¨æ‘„åƒæœºåŸç‚¹å’Œå…‰çº¿æ–¹å‘ï¼š</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line">[<span class="built_in">shader</span>(<span class="string">"raygeneration"</span>)]</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GBufferRayGen</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="comment">// Get our pixel's position on the screen</span></span><br><span class="line">  uint2 rayIdx       = <span class="built_in">DispatchRaysIndex</span>();</span><br><span class="line">  uint2 rayDim       = <span class="built_in">DispatchRaysDimensions</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Convert our ray index into a jittered ray direction.</span></span><br><span class="line">  float2 pixelCenter = (rayIdx + gPixelJitter) / rayDim;</span><br><span class="line">  float2 ndc         = <span class="built_in">float2</span>(<span class="number">2</span>, <span class="number">-2</span>) * pixelCenter + <span class="built_in">float2</span>(<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">  float3 rayDir      = ndc.x * gCamera.cameraU + </span><br><span class="line">                       ndc.y * gCamera.cameraV + </span><br><span class="line">                               gCamera.cameraW; </span><br><span class="line">  ...  </span><br></pre></td></tr></tbody></table></figure><blockquote><p>To start off, it looks very similar to our previous ray traced G-buffer. However, instead of using a fixed <code>0.5f</code> offset to shoot our ray through the center of each pixel, weâ€™ll use our computed camera jitter <code>gPixelJitter</code> as our sub-pixel offset. This gives us antialiasing as in <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">Tutorial 7</a>.</p></blockquote><p>é¦–å…ˆï¼Œå®ƒçœ‹èµ·æ¥ä¸æˆ‘ä»¬ä¹‹å‰çš„å…‰çº¿è¿½è¸ªGç¼“å†²åŒºéå¸¸ç›¸ä¼¼ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è®¡ç®—çš„ç›¸æœºæŠ–åŠ¨<code>gPixelJitter</code>ä½œä¸ºå­åƒç´ åç§»ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å›ºå®šçš„<code>0.5f</code>åç§»é‡æ¥æ‹æ‘„ç©¿è¿‡æ¯ä¸ªåƒç´ ä¸­å¿ƒçš„å…‰çº¿ã€‚è¿™ä¸ºæˆ‘ä»¬æä¾›äº†æŠ—é”¯é½¿ï¼Œå¦‚ <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor7/tutorial07.md.html">æ•™ç¨‹7</a> æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">// Find the focal point for this pixel.</span></span><br><span class="line">rayDir /= <span class="built_in">length</span>(gCamera.cameraW);                     </span><br><span class="line">float3 focalPoint = gCamera.posW + gFocalLen * rayDir; </span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure><blockquote><p>Next, we want to find the <strong>focal point</strong> for this pixel. All rays in the pixel pass through this focal point, so a ray from the camera center goes through it. Compute the right point by moving along this ray an appropriate distance. The division ensures this focal plane is planar (i.e., always the same distance from the camera along the viewing vector <code>cameraW</code>).</p></blockquote><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°æ­¤åƒç´ çš„<strong>ç„¦ç‚¹</strong>ã€‚åƒç´ ä¸­çš„æ‰€æœ‰å…‰çº¿éƒ½é€šè¿‡æ­¤ç„¦ç‚¹ï¼Œå› æ­¤æ¥è‡ªç›¸æœºä¸­å¿ƒçš„å…‰çº¿ç©¿è¿‡å®ƒã€‚é€šè¿‡æ²¿ç€è¿™æ¡å°„çº¿ç§»åŠ¨é€‚å½“çš„è·ç¦»æ¥è®¡ç®—æ­£ç¡®çš„ç‚¹ã€‚è¯¥åˆ’åˆ†ç¡®ä¿è¯¥ç„¦å¹³é¢æ˜¯å¹³é¢çš„ï¼ˆå³ï¼Œå§‹ç»ˆæ²¿è§‚å¯Ÿå‘é‡ç›¸æœºä¸ç›¸æœºä¿æŒç›¸åŒçš„è·ç¦» <code>cameraW</code> ).</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">// Initialize a random number generator</span></span><br><span class="line">uint randSeed = <span class="built_in">initRand</span>(rayIdx.x + rayIdx.y * rayDim.x, gFrameCount);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get point on lens (in polar coords then convert to Cartesian)</span></span><br><span class="line">float2 rnd    = <span class="built_in">float2</span>( <span class="built_in">nextRand</span>(randSeed) * M_2PI, </span><br><span class="line">                        <span class="built_in">nextRand</span>(randSeed) * gLensRadius );</span><br><span class="line">float2 uv     = <span class="built_in">float2</span>( <span class="built_in">cos</span>(rnd.x) * rnd.y, <span class="built_in">sin</span>(rnd.x) * rnd.y );</span><br><span class="line">...</span><br></pre></td></tr></tbody></table></figure><blockquote><p>Now we need to compute a random ray origin on our lens. To do this, we first initialize a random number generator and pick a random point on a canonical lens of the selected raidus (in polar coordinates), then convert this to a Cartesian location on the lens.</p></blockquote><p>ç°åœ¨æˆ‘ä»¬éœ€è¦è®¡ç®—é•œå¤´ä¸Šçš„éšæœºå…‰çº¿åŸç‚¹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œå¹¶åœ¨æ‰€é€‰ raidus çš„è§„èŒƒé€é•œä¸Šé€‰å–ä¸€ä¸ªéšæœºç‚¹ï¼ˆåœ¨æåæ ‡ä¸­ï¼‰ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºé€é•œä¸Šçš„ç¬›å¡å°”ä½ç½®ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="code"><pre><span class="line">  ...</span><br><span class="line">  <span class="comment">// Use uv coordinate to compute a random origin on the camera lens</span></span><br><span class="line">  float3 randomOrig = gCamera.posW + uv.x * <span class="built_in">normalize</span>(gCamera.cameraU) + </span><br><span class="line">                                     uv.y * <span class="built_in">normalize</span>(gCamera.cameraV);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Initialize a random thin lens camera ray</span></span><br><span class="line">  RayDesc ray;</span><br><span class="line">  ray.Origin    = randomOrig;                          </span><br><span class="line">  ray.Direction = <span class="built_in">normalize</span>(focalPoint - randomOrig);  </span><br><span class="line">  ray.TMin      = <span class="number">0.0f</span>;                                </span><br><span class="line">  ray.TMax      = <span class="number">1e+38</span>f;                             </span><br><span class="line">  ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><blockquote><p>Finally, we compute the random thin lens camera ray to use. We convert our random sample into an actual world space position on the camera (using the origin and the cameraâ€™s <code>u</code> and <code>v</code> vectors).</p></blockquote><p>æœ€åï¼Œæˆ‘ä»¬è®¡ç®—è¦ä½¿ç”¨çš„éšæœºè–„é•œå¤´ç›¸æœºå…‰çº¿ã€‚æˆ‘ä»¬å°†éšæœºæ ·æœ¬è½¬æ¢ä¸ºç›¸æœºä¸Šçš„å®é™…ä¸–ç•Œç©ºé—´ä½ç½®ï¼ˆä½¿ç”¨åŸç‚¹å’Œç›¸æœºçš„<code>u</code>å’Œ<code>v</code>çŸ¢é‡ï¼‰ã€‚</p><blockquote><p>Once we have the random camera origin, we can compute our random ray direction by shooting from the random origin <strong>through</strong> this pixelâ€™s focal point (computed earlier).</p></blockquote><p>ä¸€æ—¦æˆ‘ä»¬æœ‰äº†éšæœºçš„ç›¸æœºåŸç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä»éšæœºåŸç‚¹<strong>é€šè¿‡</strong>è¿™ä¸ªåƒç´ çš„ç„¦ç‚¹ï¼ˆå‰é¢è®¡ç®—ï¼‰æ¥è®¡ç®—æˆ‘ä»¬çš„éšæœºå°„çº¿æ–¹å‘ã€‚</p><blockquote><p>The rest of our G-buffer pass is identical to <code>RayTracedGBufferPass</code> from <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor4/tutorial04.md.html">Tutorial 4</a>.</p></blockquote><p>æˆ‘ä»¬çš„ G ç¼“å†²åŒºä¼ é€’çš„å…¶ä½™éƒ¨åˆ†ä¸<a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor4/tutorial04.md.html">æ•™ç¨‹ 4</a>ä¸­çš„<code>RayTracedGBufferPass</code>ç›¸åŒ.</p><h3 id="What-Does-it-Look-Like"><a href="#What-Does-it-Look-Like" class="headerlink" title="What Does it Look Like?"></a>What Does it Look Like?</h3><blockquote><p>That covers the important points of this tutorial. When running, you get the following result:</p></blockquote><p>è¿™æ¶µç›–äº†æœ¬æ•™ç¨‹çš„è¦ç‚¹ã€‚è¿è¡Œæ—¶ï¼Œæ‚¨å°†è·å¾—ä»¥ä¸‹ç»“æœï¼š</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/Tutor08-Output-20220110172811499.png"></p><blockquote><p>Hopefully, this tutorial demonstrated how to add add a simple thin lens model by randomly selecting ray origin and direction based on standard thin lens camera parameters.</p></blockquote><p>å¸Œæœ›æœ¬æ•™ç¨‹æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ ¹æ®æ ‡å‡†è–„é€é•œç›¸æœºå‚æ•°éšæœºé€‰æ‹©å…‰çº¿åŸç‚¹å’Œæ–¹å‘æ¥æ·»åŠ ç®€å•çš„è–„é€é•œç›¸æœºæ¨¡å‹ã€‚</p><blockquote><p>When you are ready, continue on to <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor9/tutorial09.md.html">Tutorial 9</a>, which swaps out our simplistic ambient occlusion shading for a slightly more complex <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Lambertian_reflectance">Lambertian</a> material model using ray traced shadows.</p></blockquote><p>å‡†å¤‡å°±ç»ªåï¼Œè¯·ç»§ç»­å­¦ä¹  <a target="_blank" rel="noopener" href="http://cwyman.org/code/dxrTutors/tutors/Tutor9/tutorial09.md.html">æ•™ç¨‹ 9</a>ï¼Œè¯¥æ•™ç¨‹å°†æˆ‘ä»¬ç®€å•çš„ç¯å¢ƒå…‰é®è”½ç€è‰²æ›¿æ¢ä¸ºä½¿ç”¨å…‰çº¿è¿½è¸ªé˜´å½±çš„ç¨å¾®å¤æ‚çš„ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Lambertian_reflectance">Lambertian</a> æè´¨æ¨¡å‹ã€‚</p></div><div class="popular-posts-header">Related Posts</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/7dbe30e4.html" rel="bookmark">Blockwise Multi-Order Feature Regression for Real-Time Path Tracing Reconstruction</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/971404c0.html" rel="bookmark">Rendering Course by Wangningbei</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/8b6729fe.html" rel="bookmark">A Gentle Introduction to DirectX Raytracing 14</a></div></li></ul><footer class="post-footer"><div class="post-tags"><a href="/tags/Computer-Graphics/" rel="tag"># Computer Graphics</a> <a href="/tags/Ray-Tracing/" rel="tag"># Ray Tracing</a></div><div class="post-nav"><div class="post-nav-item"><a href="/archives/9c36d70b.html" rel="prev" title="Extra Credits"><i class="fa fa-chevron-left"></i> Extra Credits</a></div><div class="post-nav-item"><a href="/archives/bf967c0.html" rel="next" title="A NaÃ¯ve Vim Tutorial">A NaÃ¯ve Vim Tutorial <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:e}=CONFIG.comments;if(CONFIG.comments.storage&&(e=localStorage.getItem("comments_active")||e),e){let t=document.querySelector(`a[href="#comment-${e}"]`);t&&t.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">å¼•è¨€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Our-Antialised-Rendering-Pipeline"><span class="nav-number">2.</span> <span class="nav-text">Our Antialised Rendering Pipeline</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Setting-up-Our-Thin-Lens"><span class="nav-number">3.</span> <span class="nav-text">Setting up Our Thin Lens</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DirectX-Ray-Generation-for-Jittered-Thin-Lens-Camera-Rays"><span class="nav-number">4.</span> <span class="nav-text">DirectX Ray Generation for Jittered, Thin-Lens Camera Rays</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#What-Does-it-Look-Like"><span class="nav-number">5.</span> <span class="nav-text">What Does it Look Like?</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Yousazoe" src="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><p class="site-author-name" itemprop="name">Yousazoe</p><div class="site-description" itemprop="description">done is better than perfect</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">311</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">51</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">79</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:zoeyousa@gmail.com" title="E-Mail â†’ mailto:zoeyousa@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://github.com/Yousazoe" title="GitHub â†’ https://github.com/Yousazoe" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://twitter.com/YousaZoe" title="Twitter â†’ https://twitter.com/YousaZoe" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://steamcommunity.com/profiles/76561198856466228/" title="Steam â†’ https://steamcommunity.com/profiles/76561198856466228/" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.chess.com/member/yousazoe" title="Chess â†’ https://www.chess.com/member/yousazoe" rel="noopener" target="_blank"><i class="fa fa-chess-pawn fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/399504060" title="Bilibili â†’ https://space.bilibili.com/399504060" rel="noopener" target="_blank"><i class="fa fa-th-large fa-fw"></i></a> </span><span class="links-of-author-item"><a href="/atom.xml" title="RSS â†’ /atom.xml"><i class="fa fa-rss fa-fw"></i></a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="twopeople"><div class="container" style="height:200px"><canvas class="illo" width="800" height="800" style="max-width:200px;max-height:200px;touch-action:none;width:640px;height:640px"></canvas></div><script src="https://img.yousazoe.top/js/twopeople1.js"></script><script src="https://img.yousazoe.top/js/zdog.dist.js"></script><script id="rendered-js" src="https://img.yousazoe.top/js/twopeople.js"></script><style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style></div><div class="cc-license animated" itemprop="sponsor"><link rel="preconnect" href="https://www.netlify.com"><span class="exturl cc-opacity" title="Deploy with Netlify â†’ https://www.netlify.com" data-url="aHR0cHM6Ly93d3cubmV0bGlmeS5jb20="><img width="80" src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://www.netlify.com/img/global/badges/netlify-dark.svg" alt="Netlify"></span></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="translate-style">ç¹/ç®€ï¼š<a id="translateLink" href="javascript:translatePage();">ç¹ä½“</a></div><script type="text/javascript" src="/js/tw_cn.js"></script><script type="text/javascript">var defaultEncoding=2,translateDelay=0,cookieDomain="https://tding.top/",msgToTraditionalChinese="ç¹ä½“",msgToSimplifiedChinese="ç®€ä½“",translateButtonId="translateLink";translateInitilization()</script><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">æ™‹ICPå¤‡2021009930å· </a><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/icon/beian.png" style="display:inline-block"></div><div class="copyright">Â© 2020 â€“ <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Yousazoe</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="Symbols count total">4.7m</span></div><div class="powered-by"><span><a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/YukiNoUta/cdn-static@main/blog/svg/upyun.svg" width="53" height="18" style="fill:currentColor;display:inline-block"></a></span><span class="post-meta-divider">|</span>ä»Šæ—©é›¾éœ¾è”½æ—¥ï¼Œä½†æ˜¯ä¸è¦å®³æ€•ï¼Œå¤ªé˜³ä¾æ—§åœ¨äº‘ç«¯</div><div class="busuanzi-count"><script data-pjax="" async="" src="js/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="//unpkg.com/animejs@3.1.0/lib/anime.min.js"></script><script src="//npm.elemecdn.com/pjax/pjax.min.js"></script><script src="//lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="//unpkg.com/lozad@1.16.0/dist/lozad.min.js"></script><script src="//lib.baomitu.com/pangu/4.0.7/pangu.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
    $(document).ready(function () {

    if(location.href.indexOf("#reloaded")==-1){
        location.href=location.href+"#reloaded";
        location.reload();
    }
}ï¼‰
#åœ¨è¿™åé¢å¯ä»¥åŠ å…¥ç¨‹åºçš„å…¶ä»–ä»£ç   


  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });

  
  NexT.boot.refresh();
  
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  
  NexT.utils.updateSidebarPosition();
});</script><script defer="" src="//img.yousazoe.top/js/three.min.js"></script><script defer="" src="//img.yousazoe.top/js/caidai.js"></script><script data-pjax="">!function(){var e,t,o,n,r=document.getElementsByTagName("link");if(0<r.length)for(i=0;i<r.length;i++)"canonical"==r[i].rel.toLowerCase()&&r[i].href&&(e=r[i].href);t=(e||window.location.protocol).split(":")[0],e=e||window.location.href,window,o=e,n=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(o)||(t="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",n?(t+="?r="+encodeURIComponent(document.referrer),o&&(t+="&l="+o)):o&&(t+="?l="+o),(new Image).src=t)}()</script><script src="/js/local-search.js"></script><script data-pjax="">document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),r=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script data-pjax="">document.querySelectorAll("pre.mermaid").length&&NexT.utils.getScript("//lib.baomitu.com/mermaid/8.4.8/mermaid.min.js",()=>{mermaid.initialize({theme:"forest",logLevel:3,flowchart:{curve:"linear"},gantt:{axisFormat:"%m/%d/%Y"},sequence:{actorMargin:50}})},window.mermaid)</script><div id="pjax"><script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"64px",right:"unset",left:"32px",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"ğŸŒ“",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);window.darkmode=darkmode,darkmode.showWidget()</script></div><script type="text/javascript" src="/js/cursor/fireworks.js"></script><script src="https://img.yousazoe.top/live2dw/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/hijiki.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!0},log:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:5,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},t.src!==o&&(i.src=o)}()}o(),n.addEventListener("scroll",function(){var t=o,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script type="text/javascript" charset="utf-8" src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script></body></html>