<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico"><link rel="mask-icon" href="/images/favicon.ico" color="#222"><meta name="google-site-verification" content="35AYyqm-wpmGmXtkn-vQMrk7AkFl1Do55uHdlLLLT38"><meta name="baidu-site-verification" content="slBbq5f8WxljPytW"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/5.15.4/css/all.min.css"><link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//unpkg.com/pace-js@1/themes/blue/pace-theme-minimal.css"><script src="//unpkg.com/pace-js@1.2.4/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"yousazoe.top",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"mac"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!0,comments:{style:"tabs",active:null,storage:!0,lazyload:!0,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:3,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="引言Adding logic to the Starcraft 2 artificial intelligence to defend our main base."><meta property="og:type" content="article"><meta property="og:title" content="Defending Ourselves"><meta property="og:url" content="https://yousazoe.top/archives/1c1975a5.html"><meta property="og:site_name" content="Fl0w3r"><meta property="og:description" content="引言Adding logic to the Starcraft 2 artificial intelligence to defend our main base."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/SCII2/ELjcex.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/basic-game-running-20220311122828031.jpg"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/SCII2/tF8kdl.jpg"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/SCII2/KHNqOx.jpg"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/SCII2/4ShSlv.jpg"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/SCII2/mq8mQf.jpg"><meta property="og:image" content="https://img.yousazoe.top/uPic/img/blog/SCII2/9HYzV3.jpg"><meta property="article:published_time" content="2022-03-10T14:00:38.000Z"><meta property="article:modified_time" content="2022-08-22T15:53:29.443Z"><meta property="article:author" content="Yousazoe"><meta property="article:tag" content="Python"><meta property="article:tag" content="StarCraft2"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.yousazoe.top/uPic/img/blog/SCII2/ELjcex.jpg"><link rel="canonical" href="https://yousazoe.top/archives/1c1975a5.html"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>Defending Ourselves | Fl0w3r</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Fl0w3r" type="application/atom+xml"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Fl0w3r</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">carpe diem</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-address-card fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-paperclip fa-fw"></i>Links</a></li><li class="menu-item menu-item-photos"><a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>Photos</a></li><li class="menu-item menu-item-artitalk"><a href="/artitalk/" rel="section"><i class="fa fa-calendar fa-fw"></i>Artitalk</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-document"><a href="/docs/" rel="section"><i class="fas fa-book fa-fw"></i>Document</a></li><li class="menu-item menu-item-qexoadmin"><a href="https://blog-yousazoe-qexo.vercel.app/" rel="noopener" target="_blank"><i class="fa fa-database fa-fw"></i>QexoAdmin</a></li><li class="menu-item menu-item-gametracker"><a href="https://yousazoe.notion.site/yousazoe/b05999823bd14b57a7a6cd81fba1a1af?v=21c3398e0bdb429c9b8157b7bf12ff6a" rel="noopener" target="_blank"><i class="fas fa-trophy fa-fw"></i>GameTracker</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://yousazoe.top/archives/1c1975a5.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><meta itemprop="name" content="Yousazoe"><meta itemprop="description" content="done is better than perfect"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Fl0w3r"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Defending Ourselves</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2022-03-10 22:00:38" itemprop="dateCreated datePublished" datetime="2022-03-10T22:00:38+08:00">2022-03-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/%E6%98%9F%E9%99%85%E4%BA%89%E9%9C%B82%E4%B8%8E%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD-Building-Starcraft-2-AI-in-Python-with-Python-sc2/" itemprop="url" rel="index"><span itemprop="name">星际争霸2与人工智能 (Building Starcraft 2 AI in Python with Python-sc2)</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="fas fa-pen"></i></span><span>15k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span>27 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/SCII2/ELjcex.jpg"></p><h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p>Adding logic to the Starcraft 2 artificial intelligence to defend our main base.</p><span id="more"></span><iframe width="560" height="315" src="https://www.youtube.com/embed/fqEzFZ2z6S4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe src="//player.bilibili.com/player.html?aid=767590395&amp;bvid=BV1Lr4y1W7b9&amp;cid=557746922&amp;page=1&amp;high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen=""></iframe><p>Welcome to part 2 of the Starcraft 2 tutorials. Where we left off, we had established some of the basics of the game, as well as writing and running our own basic script to start. The code so far:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sc2.bot_ai <span class="keyword">import</span> BotAI  <span class="comment"># parent class we inherit from</span></span><br><span class="line"><span class="keyword">from</span> sc2.data <span class="keyword">import</span> Difficulty, Race  <span class="comment"># difficulty for bots, race for the 1 of 3 races</span></span><br><span class="line"><span class="keyword">from</span> sc2.main <span class="keyword">import</span> run_game  <span class="comment"># function that facilitates actually running the agents in games</span></span><br><span class="line"><span class="keyword">from</span> sc2.player <span class="keyword">import</span> Bot, Computer  <span class="comment">#wrapper for whether or not the agent is one of your bots, or a "computer" player</span></span><br><span class="line"><span class="keyword">from</span> sc2 <span class="keyword">import</span> maps  <span class="comment"># maps method for loading maps to play in.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IncrediBot</span>(<span class="title class_ inherited__">BotAI</span>): <span class="comment"># inhereits from BotAI (part of BurnySC2)</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">on_step</span>(<span class="params">self, iteration: <span class="built_in">int</span></span>): <span class="comment"># on_step is a method that is called every step of the game.</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"This is my bot in iteration <span class="subst">{iteration}</span>"</span>) <span class="comment"># prints out the iteration number (ie: the step).</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">run_game(  <span class="comment"># run_game is a function that runs the game.</span></span><br><span class="line">    maps.get(<span class="string">"2000AtmospheresAIE"</span>), <span class="comment"># the map we are playing on</span></span><br><span class="line">    [Bot(Race.Protoss, IncrediBot()), <span class="comment"># runs our coded bot, protoss race, and we pass our bot object </span></span><br><span class="line">     Computer(Race.Zerg, Difficulty.Hard)], <span class="comment"># runs a pre-made computer agent, zerg race, with a hard difficulty.</span></span><br><span class="line">    realtime=<span class="literal">False</span>, <span class="comment"># When set to True, the agent is limited in how long each step can take to process.</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure><p>To continue, I’ll start by modifying the print statement a bit to contain information on our buildings and units:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">on_step</span>(<span class="params">self, iteration: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="comment">#print(f"This is my bot in iteration {iteration}, workers: {self.workers}, idle workers: {self.workers.idle}, supply: {self.supply_used}/{self.supply_cap}")</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"<span class="subst">{iteration}</span>, n_workers: <span class="subst">{self.workers.amount}</span>, n_idle_workers: <span class="subst">{self.workers.idle.amount}</span>,"</span>, \</span><br><span class="line">        <span class="string">f"minerals: <span class="subst">{self.minerals}</span>, gas: <span class="subst">{self.vespene}</span>, cannons: <span class="subst">{self.structures(UnitTypeId.PHOTONCANNON).amount}</span>,"</span>, \</span><br><span class="line">        <span class="string">f"pylons: <span class="subst">{self.structures(UnitTypeId.PYLON).amount}</span>, nexus: <span class="subst">{self.structures(UnitTypeId.NEXUS).amount}</span>"</span>, \</span><br><span class="line">        <span class="string">f"gateways: <span class="subst">{self.structures(UnitTypeId.GATEWAY).amount}</span>, cybernetics cores: <span class="subst">{self.structures(UnitTypeId.CYBERNETICSCORE).amount}</span>"</span>, \</span><br><span class="line">        <span class="string">f"stargates: <span class="subst">{self.structures(UnitTypeId.STARGATE).amount}</span>, voidrays: <span class="subst">{self.units(UnitTypeId.VOIDRAY).amount}</span>, supply: <span class="subst">{self.supply_used}</span>/<span class="subst">{self.supply_cap}</span>"</span>)</span><br><span class="line">  </span><br></pre></td></tr></tbody></table></figure><p>Here, we’re just outputting the numbers of various buildings, units, and supply information. The idea here is mainly just for debugging purposes. If we add logic that we think will build a Stargate, but one isn’t built, then the next question we’d have is if a Cybernetics core exists and if we had the supplies necessary to build the Stargate.</p><p>We’re also using <code>UnitTypeId</code> here, so we’ll need to import that:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sc2.ids.unit_typeid <span class="keyword">import</span> UnitTypeId</span><br></pre></td></tr></tbody></table></figure><p>Next, since the game is very hierarchical, everything we do (nearly) requires us to have at least one Nexus. If we’ve lost the Nexus, then really our top priority is to make another one as soon as possible, or I suppose maybe destroy the enemy if you can. So, our logic, at least for now, will start with a Nexus check (note that we use self.townhalls here, which is race-generic for checking the existence of this sort of main building):</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># begin logic:</span></span><br><span class="line"><span class="keyword">if</span> self.townhalls:  <span class="comment"># do we have a nexus?</span></span><br><span class="line">    nexus = self.townhalls.random  <span class="comment"># select one (will just be one for now)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.NEXUS):  <span class="comment"># can we afford one?</span></span><br><span class="line">        <span class="keyword">await</span> self.expand_now()  <span class="comment"># build one!</span></span><br></pre></td></tr></tbody></table></figure><p>For now, we’ll be peaceful and just build a bunch of workers (if we have a nexus).</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">     <span class="keyword">if</span> nexus.is_idle <span class="keyword">and</span> self.can_afford(UnitTypeId.PROBE):</span><br><span class="line">nexus.train(UnitTypeId.PROBE)</span><br></pre></td></tr></tbody></table></figure><p>Full code up to this point:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sc2.bot_ai <span class="keyword">import</span> BotAI  <span class="comment"># parent class we inherit from</span></span><br><span class="line"><span class="keyword">from</span> sc2.data <span class="keyword">import</span> Difficulty, Race  <span class="comment"># difficulty for bots, race for the 1 of 3 races</span></span><br><span class="line"><span class="keyword">from</span> sc2.main <span class="keyword">import</span> run_game  <span class="comment"># function that facilitates actually running the agents in games</span></span><br><span class="line"><span class="keyword">from</span> sc2.player <span class="keyword">import</span> Bot, Computer  <span class="comment">#wrapper for whether or not the agent is one of your bots, or a "computer" player</span></span><br><span class="line"><span class="keyword">from</span> sc2 <span class="keyword">import</span> maps  <span class="comment"># maps method for loading maps to play in.</span></span><br><span class="line"><span class="keyword">from</span> sc2.ids.unit_typeid <span class="keyword">import</span> UnitTypeId</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IncrediBot</span>(<span class="title class_ inherited__">BotAI</span>): <span class="comment"># inhereits from BotAI (part of BurnySC2)</span></span><br><span class="line">	<span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">on_step</span>(<span class="params">self, iteration: <span class="built_in">int</span></span>): <span class="comment"># on_step is a method that is called every step of the game.</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">f"<span class="subst">{iteration}</span>, n_workers: <span class="subst">{self.workers.amount}</span>, n_idle_workers: <span class="subst">{self.workers.idle.amount}</span>,"</span>, \</span><br><span class="line">			<span class="string">f"minerals: <span class="subst">{self.minerals}</span>, gas: <span class="subst">{self.vespene}</span>, cannons: <span class="subst">{self.structures(UnitTypeId.PHOTONCANNON).amount}</span>,"</span>, \</span><br><span class="line">			<span class="string">f"pylons: <span class="subst">{self.structures(UnitTypeId.PYLON).amount}</span>, nexus: <span class="subst">{self.structures(UnitTypeId.NEXUS).amount}</span>"</span>, \</span><br><span class="line">			<span class="string">f"gateways: <span class="subst">{self.structures(UnitTypeId.GATEWAY).amount}</span>, cybernetics cores: <span class="subst">{self.structures(UnitTypeId.CYBERNETICSCORE).amount}</span>"</span>, \</span><br><span class="line">			<span class="string">f"stargates: <span class="subst">{self.structures(UnitTypeId.STARGATE).amount}</span>, voidrays: <span class="subst">{self.units(UnitTypeId.VOIDRAY).amount}</span>, supply: <span class="subst">{self.supply_used}</span>/<span class="subst">{self.supply_cap}</span>"</span>)</span><br><span class="line">		</span><br><span class="line">		<span class="comment"># begin logic:</span></span><br><span class="line">		<span class="keyword">if</span> self.townhalls:  <span class="comment"># do we have a nexus?</span></span><br><span class="line">			nexus = self.townhalls.random  <span class="comment"># select one (will just be one for now)</span></span><br><span class="line">			<span class="keyword">if</span> nexus.is_idle <span class="keyword">and</span> self.can_afford(UnitTypeId.PROBE):  </span><br><span class="line">				nexus.train(UnitTypeId.PROBE)  <span class="comment"># train a probe</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">if</span> self.can_afford(UnitTypeId.NEXUS):  <span class="comment"># can we afford one?</span></span><br><span class="line">				<span class="keyword">await</span> self.expand_now()  <span class="comment"># build one!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">run_game(  <span class="comment"># run_game is a function that runs the game.</span></span><br><span class="line">	maps.get(<span class="string">"2000AtmospheresAIE"</span>), <span class="comment"># the map we are playing on</span></span><br><span class="line">	[Bot(Race.Protoss, IncrediBot()), <span class="comment"># runs our coded bot, protoss race, and we pass our bot object </span></span><br><span class="line">		Computer(Race.Zerg, Difficulty.Hard)], <span class="comment"># runs a pre-made computer agent, zerg race, with a hard difficulty.</span></span><br><span class="line">	realtime=<span class="literal">False</span>, <span class="comment"># When set to True, the agent is limited in how long each step can take to process.</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure><p>Running this, it looks pretty similar to our runs before:</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/Yousazoe/picgo-repo/img/basic-game-running-20220311122828031.jpg"></p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/SCII2/tF8kdl.jpg"></p><p>Before we can do much, we definitely need resources, and we might want more units. To increase units, we need more <code>Supply</code>. For that, with Protoss, we need Pylons. I’ll just come up with some logic to put down, but where you place these Pylons does matter. These are what powers your buildings and dictates where units can be warped in. Strategically, these matter a lot. For now, we just need some. So, to begin, we’ll start our main <code>elif</code> chain, which essentially is a ranking of things, in the order of how important they are to us to exist, and all of this is contained under the if statement checking to see if a Nexus exists.</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># if we dont have *any* pylons, we'll build one close to the nexus.</span></span><br><span class="line"><span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.PYLON) <span class="keyword">and</span> self.already_pending(UnitTypeId.PYLON) == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">        <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=nexus)</span><br></pre></td></tr></tbody></table></figure><p>As far as I can tell, the SC2 package takes care of grabbing a worker and building things when you ask it to. I am sure there’s a way you can take control of this to be more precise. For now, however, this works well. In order to make room for more buildings and our attack units, we’ll probably want more pylons than this. For now, let’s presume we want 5.</p><p>These Pylons need to be close to eachother to build a “matrix,” so we want them close, but if we just build all of them near our Nexus, chances are we’ll put them way too close together and possibly even block ourselves from leaving our starting area, so we want to employ some logic about how to “expand” outwards. For now, that logic will be to build near the nearest-to-the-enemy pylon, continuing towards the enemy:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">elif</span> self.structures(UnitTypeId.PYLON).amount &lt; <span class="number">5</span>:</span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">        <span class="comment"># build from the closest pylon towards the enemy</span></span><br><span class="line">        target_pylon = self.structures(UnitTypeId.PYLON).closest_to(self.enemy_start_locations[<span class="number">0</span>])</span><br><span class="line">        <span class="comment"># build as far away from target_pylon as possible:</span></span><br><span class="line">        pos = target_pylon.position.towards(self.enemy_start_locations[<span class="number">0</span>], random.randrange(<span class="number">8</span>, <span class="number">15</span>))</span><br><span class="line">        <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=pos)</span><br></pre></td></tr></tbody></table></figure><p>Full code up to this point:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sc2.bot_ai <span class="keyword">import</span> BotAI  <span class="comment"># parent class we inherit from</span></span><br><span class="line"><span class="keyword">from</span> sc2.data <span class="keyword">import</span> Difficulty, Race  <span class="comment"># difficulty for bots, race for the 1 of 3 races</span></span><br><span class="line"><span class="keyword">from</span> sc2.main <span class="keyword">import</span> run_game  <span class="comment"># function that facilitates actually running the agents in games</span></span><br><span class="line"><span class="keyword">from</span> sc2.player <span class="keyword">import</span> Bot, Computer  <span class="comment">#wrapper for whether or not the agent is one of your bots, or a "computer" player</span></span><br><span class="line"><span class="keyword">from</span> sc2 <span class="keyword">import</span> maps  <span class="comment"># maps method for loading maps to play in.</span></span><br><span class="line"><span class="keyword">from</span> sc2.ids.unit_typeid <span class="keyword">import</span> UnitTypeId</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IncrediBot</span>(<span class="title class_ inherited__">BotAI</span>): <span class="comment"># inhereits from BotAI (part of BurnySC2)</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">on_step</span>(<span class="params">self, iteration: <span class="built_in">int</span></span>): <span class="comment"># on_step is a method that is called every step of the game.</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"<span class="subst">{iteration}</span>, n_workers: <span class="subst">{self.workers.amount}</span>, n_idle_workers: <span class="subst">{self.workers.idle.amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"minerals: <span class="subst">{self.minerals}</span>, gas: <span class="subst">{self.vespene}</span>, cannons: <span class="subst">{self.structures(UnitTypeId.PHOTONCANNON).amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"pylons: <span class="subst">{self.structures(UnitTypeId.PYLON).amount}</span>, nexus: <span class="subst">{self.structures(UnitTypeId.NEXUS).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"gateways: <span class="subst">{self.structures(UnitTypeId.GATEWAY).amount}</span>, cybernetics cores: <span class="subst">{self.structures(UnitTypeId.CYBERNETICSCORE).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"stargates: <span class="subst">{self.structures(UnitTypeId.STARGATE).amount}</span>, voidrays: <span class="subst">{self.units(UnitTypeId.VOIDRAY).amount}</span>, supply: <span class="subst">{self.supply_used}</span>/<span class="subst">{self.supply_cap}</span>"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># begin logic:</span></span><br><span class="line">        <span class="keyword">if</span> self.townhalls:  <span class="comment"># do we have a nexus?</span></span><br><span class="line">            nexus = self.townhalls.random  <span class="comment"># select one (will just be one for now)</span></span><br><span class="line">            <span class="keyword">if</span> nexus.is_idle <span class="keyword">and</span> self.can_afford(UnitTypeId.PROBE):  </span><br><span class="line">                nexus.train(UnitTypeId.PROBE)  <span class="comment"># train a probe</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we dont have *any* pylons, we'll build one close to the nexus.</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.PYLON) <span class="keyword">and</span> self.already_pending(UnitTypeId.PYLON) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=nexus)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.PYLON).amount &lt; <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="comment"># build from the closest pylon towards the enemy</span></span><br><span class="line">                    target_pylon = self.structures(UnitTypeId.PYLON).closest_to(self.enemy_start_locations[<span class="number">0</span>])</span><br><span class="line">                    <span class="comment"># build as far away from target_pylon as possible:</span></span><br><span class="line">                    pos = target_pylon.position.towards(self.enemy_start_locations[<span class="number">0</span>], random.randrange(<span class="number">8</span>, <span class="number">15</span>))</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=pos)</span><br><span class="line">                    </span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> self.can_afford(UnitTypeId.NEXUS):  <span class="comment"># can we afford one?</span></span><br><span class="line">                <span class="keyword">await</span> self.expand_now()  <span class="comment"># build one!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">run_game(  <span class="comment"># run_game is a function that runs the game.</span></span><br><span class="line">    maps.get(<span class="string">"2000AtmospheresAIE"</span>), <span class="comment"># the map we are playing on</span></span><br><span class="line">    [Bot(Race.Protoss, IncrediBot()), <span class="comment"># runs our coded bot, protoss race, and we pass our bot object </span></span><br><span class="line">     Computer(Race.Zerg, Difficulty.Hard)], <span class="comment"># runs a pre-made computer agent, zerg race, with a hard difficulty.</span></span><br><span class="line">    realtime=<span class="literal">False</span>, <span class="comment"># When set to True, the agent is limited in how long each step can take to process.</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure><iframe src="//player.bilibili.com/player.html?aid=510002180&amp;bvid=BV1Bu411q7bi&amp;cid=557729934&amp;page=1&amp;high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen=""></iframe><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/SCII2/KHNqOx.jpg"></p><p>In this example, we have 24/16 workers, but we will wind up likely with even more as the game progresses. With protoss, at 16 units per Nexus, you have the most efficiency per worker. This declines a bit to 24/16, and if I understand correctly, workers will wind up essentially being idle at more than 24 per nexus.</p><p>Next, we still find ourselves under attack usually within 1,000 steps of the game:</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/SCII2/4ShSlv.jpg"></p><p>To possibly help with this, we can build Cannons. Cannons are stationary, yet powerful buildings that can do a healthy amount of damage. There’s even a strategy with Protoss to quickly build cannons at the enemy’s base. We won’t be doing that for now, and will instead just try to build up our defenses a bit to deter enemy attacks.</p><p>You may also have noticed that we have idle workers. While we have way too many workers per nexus, this doesn’t really matter much, but this could catch us off guard later. To handle for this, the very first thing we’ll do in the loop after the print statement is:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">await</span> self.distribute_workers()</span><br></pre></td></tr></tbody></table></figure><p>This will put the workers back to work. They probably went idle after building a building.</p><p>Since we want to build cannons, we need to revist the <a target="_blank" rel="noopener" href="https://liquipedia.net/starcraft2/Protoss_Units_(Legacy_of_the_Void)"><strong>Protoss Unit tree</strong></a>. This informs us that, if we want cannons, we first need to build a <code>Forge</code>. I’ll add this to the <code>elif</code> list.</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.FORGE):  <span class="comment"># if we don't have a forge:</span></span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.FORGE):  <span class="comment"># and we can afford one:</span></span><br><span class="line">        <span class="comment"># build one near the Pylon that is closest to the nexus:</span></span><br><span class="line">        <span class="keyword">await</span> self.build(UnitTypeId.FORGE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br></pre></td></tr></tbody></table></figure><p>Take note here of all of the helper methods that we have available to us for logically building/placing things, especially with that build line, allowing us to build a forge not just close to a Pylon (recall we need to build buildings within the matrix of Pylons), but also close to the Pylon that’s closest to the Nexus. Again, there are certainly ways to take full control over exact building locations, and this might help you to be even more strategic, but all these helper capabilities sure do make building SC2 agent logic very fast and easy!</p><p>Once we have a forge, let’s build up to 3 cannons around our base for defenses:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># if we have less than 3 cannons, let's build some more if possible:</span></span><br><span class="line"><span class="keyword">elif</span> self.structures(UnitTypeId.FORGE).ready <span class="keyword">and</span> self.structures(UnitTypeId.PHOTONCANNON).amount &lt; <span class="number">3</span>:</span><br><span class="line">    <span class="keyword">if</span> self.can_afford(UnitTypeId.PHOTONCANNON):  <span class="comment"># can we afford a cannon?</span></span><br><span class="line">        <span class="keyword">await</span> self.build(UnitTypeId.PHOTONCANNON, near=nexus)  <span class="comment"># build one near the nexus</span></span><br></pre></td></tr></tbody></table></figure><p>With this, the full SC2 <code>IncrediBot</code> code is:</p><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sc2.bot_ai <span class="keyword">import</span> BotAI  <span class="comment"># parent class we inherit from</span></span><br><span class="line"><span class="keyword">from</span> sc2.data <span class="keyword">import</span> Difficulty, Race  <span class="comment"># difficulty for bots, race for the 1 of 3 races</span></span><br><span class="line"><span class="keyword">from</span> sc2.main <span class="keyword">import</span> run_game  <span class="comment"># function that facilitates actually running the agents in games</span></span><br><span class="line"><span class="keyword">from</span> sc2.player <span class="keyword">import</span> Bot, Computer  <span class="comment">#wrapper for whether or not the agent is one of your bots, or a "computer" player</span></span><br><span class="line"><span class="keyword">from</span> sc2 <span class="keyword">import</span> maps  <span class="comment"># maps method for loading maps to play in.</span></span><br><span class="line"><span class="keyword">from</span> sc2.ids.unit_typeid <span class="keyword">import</span> UnitTypeId</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IncrediBot</span>(<span class="title class_ inherited__">BotAI</span>): <span class="comment"># inhereits from BotAI (part of BurnySC2)</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">on_step</span>(<span class="params">self, iteration: <span class="built_in">int</span></span>): <span class="comment"># on_step is a method that is called every step of the game.</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"<span class="subst">{iteration}</span>, n_workers: <span class="subst">{self.workers.amount}</span>, n_idle_workers: <span class="subst">{self.workers.idle.amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"minerals: <span class="subst">{self.minerals}</span>, gas: <span class="subst">{self.vespene}</span>, cannons: <span class="subst">{self.structures(UnitTypeId.PHOTONCANNON).amount}</span>,"</span>, \</span><br><span class="line">            <span class="string">f"pylons: <span class="subst">{self.structures(UnitTypeId.PYLON).amount}</span>, nexus: <span class="subst">{self.structures(UnitTypeId.NEXUS).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"gateways: <span class="subst">{self.structures(UnitTypeId.GATEWAY).amount}</span>, cybernetics cores: <span class="subst">{self.structures(UnitTypeId.CYBERNETICSCORE).amount}</span>"</span>, \</span><br><span class="line">            <span class="string">f"stargates: <span class="subst">{self.structures(UnitTypeId.STARGATE).amount}</span>, voidrays: <span class="subst">{self.units(UnitTypeId.VOIDRAY).amount}</span>, supply: <span class="subst">{self.supply_used}</span>/<span class="subst">{self.supply_cap}</span>"</span>)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment"># begin logic:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> self.distribute_workers() <span class="comment"># put idle workers back to work</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.townhalls:  <span class="comment"># do we have a nexus?</span></span><br><span class="line">            nexus = self.townhalls.random  <span class="comment"># select one (will just be one for now)</span></span><br><span class="line">            <span class="keyword">if</span> nexus.is_idle <span class="keyword">and</span> self.can_afford(UnitTypeId.PROBE):  </span><br><span class="line">                nexus.train(UnitTypeId.PROBE)  <span class="comment"># train a probe</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we dont have *any* pylons, we'll build one close to the nexus.</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.PYLON) <span class="keyword">and</span> self.already_pending(UnitTypeId.PYLON) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=nexus)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.PYLON).amount &lt; <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PYLON):</span><br><span class="line">                    <span class="comment"># build from the closest pylon towards the enemy</span></span><br><span class="line">                    target_pylon = self.structures(UnitTypeId.PYLON).closest_to(self.enemy_start_locations[<span class="number">0</span>])</span><br><span class="line">                    <span class="comment"># build as far away from target_pylon as possible:</span></span><br><span class="line">                    pos = target_pylon.position.towards(self.enemy_start_locations[<span class="number">0</span>], random.randrange(<span class="number">8</span>, <span class="number">15</span>))</span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PYLON, near=pos)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> self.structures(UnitTypeId.FORGE):  <span class="comment"># if we don't have a forge:</span></span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.FORGE):  <span class="comment"># and we can afford one:</span></span><br><span class="line">                    <span class="comment"># build one near the Pylon that is closest to the nexus:</span></span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.FORGE, near=self.structures(UnitTypeId.PYLON).closest_to(nexus))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># if we have less than 3 cannons, let's build some more if possible:</span></span><br><span class="line">            <span class="keyword">elif</span> self.structures(UnitTypeId.FORGE).ready <span class="keyword">and</span> self.structures(UnitTypeId.PHOTONCANNON).amount &lt; <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">if</span> self.can_afford(UnitTypeId.PHOTONCANNON):  <span class="comment"># can we afford a cannon?</span></span><br><span class="line">                    <span class="keyword">await</span> self.build(UnitTypeId.PHOTONCANNON, near=nexus)  <span class="comment"># build one near the nexus</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> self.can_afford(UnitTypeId.NEXUS):  <span class="comment"># can we afford one?</span></span><br><span class="line">                <span class="keyword">await</span> self.expand_now()  <span class="comment"># build one!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">run_game(  <span class="comment"># run_game is a function that runs the game.</span></span><br><span class="line">    maps.get(<span class="string">"2000AtmospheresAIE"</span>), <span class="comment"># the map we are playing on</span></span><br><span class="line">    [Bot(Race.Protoss, IncrediBot()), <span class="comment"># runs our coded bot, protoss race, and we pass our bot object </span></span><br><span class="line">     Computer(Race.Zerg, Difficulty.Hard)], <span class="comment"># runs a pre-made computer agent, zerg race, with a hard difficulty.</span></span><br><span class="line">    realtime=<span class="literal">False</span>, <span class="comment"># When set to True, the agent is limited in how long each step can take to process.</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure><p>Running this, we should see things are fairly improved. For example, we do still get attacked around 1,000 to 1,200 steps in:</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/SCII2/mq8mQf.jpg"></p><p>With multiple runs, sometimes we’re still defeated, but sometimes we actually survive the attack, like here:</p><p><img data-src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/SCII2/9HYzV3.jpg"></p><p>Of course, eventually we’ll still be defeated here, without either expanding more and making even more defenses, making it essentially impossible for the enemy to have enough resources to kill us, or, for us to go on the offensive, and to actually attack the enemy. With cannons, we can’t really move them, but with quite a few units, we can actually move them and use them both for defense as well as offense. This will be the focus of the next tutorial.</p></div><div class="popular-posts-header">Related Posts</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/ebbc29f6.html" rel="bookmark">Attacking and Defeating the Enemy</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/ed318fdd.html" rel="bookmark">Introduction</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="/archives/595d9f82.html" rel="bookmark">Simple StarCraft 2 Bot Template to Get Started</a></div></li></ul><footer class="post-footer"><div class="post-tags"><a href="/tags/Python/" rel="tag"># Python</a> <a href="/tags/StarCraft2/" rel="tag"># StarCraft2</a></div><div class="post-nav"><div class="post-nav-item"><a href="/archives/ed318fdd.html" rel="prev" title="Introduction"><i class="fa fa-chevron-left"></i> Introduction</a></div><div class="post-nav-item"><a href="/archives/ebbc29f6.html" rel="next" title="Attacking and Defeating the Enemy">Attacking and Defeating the Enemy <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:e}=CONFIG.comments;if(CONFIG.comments.storage&&(e=localStorage.getItem("comments_active")||e),e){let t=document.querySelector(`a[href="#comment-${e}"]`);t&&t.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">引言</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Yousazoe" src="https://img.yousazoe.top/uPic/img/blog/icon/icon.jpeg"><p class="site-author-name" itemprop="name">Yousazoe</p><div class="site-description" itemprop="description">done is better than perfect</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">285</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">45</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">71</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:zoeyousa@gmail.com" title="E-Mail → mailto:zoeyousa@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://github.com/Yousazoe" title="GitHub → https://github.com/Yousazoe" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://twitter.com/YousaZoe" title="Twitter → https://twitter.com/YousaZoe" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.weibo.com/6034231696/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo&amp;is_all=1" title="Weibo → https://www.weibo.com/6034231696/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo&amp;is_all=1" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://steamcommunity.com/profiles/76561198856466228/" title="Steam → https://steamcommunity.com/profiles/76561198856466228/" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i></a> </span><span class="links-of-author-item"><a href="https://www.chess.com/member/yousazoe" title="Chess → https://www.chess.com/member/yousazoe" rel="noopener" target="_blank"><i class="fa fa-chess-pawn fa-fw"></i></a> </span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml"><i class="fa fa-rss fa-fw"></i></a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="twopeople"><div class="container" style="height:200px"><canvas class="illo" width="800" height="800" style="max-width:200px;max-height:200px;touch-action:none;width:640px;height:640px"></canvas></div><script src="https://img.yousazoe.top/js/twopeople1.js"></script><script src="https://img.yousazoe.top/js/zdog.dist.js"></script><script id="rendered-js" src="https://img.yousazoe.top/js/twopeople.js"></script><style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style></div><div class="cc-license animated" itemprop="sponsor"><link rel="preconnect" href="https://www.netlify.com"><span class="exturl cc-opacity" title="Deploy with Netlify → https://www.netlify.com" data-url="aHR0cHM6Ly93d3cubmV0bGlmeS5jb20="><img width="80" src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://www.netlify.com/img/global/badges/netlify-dark.svg" alt="Netlify"></span></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="translate-style">繁/简：<a id="translateLink" href="javascript:translatePage();">繁体</a></div><script type="text/javascript" src="/js/tw_cn.js"></script><script type="text/javascript">var defaultEncoding=2,translateDelay=0,cookieDomain="https://tding.top/",msgToTraditionalChinese="繁体",msgToSimplifiedChinese="简体",translateButtonId="translateLink";translateInitilization()</script><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">晋ICP备2021009930号 </a><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://img.yousazoe.top/uPic/img/blog/icon/beian.png" style="display:inline-block"></div><div class="copyright">© 2020 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Yousazoe</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="Symbols count total">4.4m</span></div><div class="powered-by"><span><a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img src="https://img.yousazoe.top/uPic/img/blog/icon/mona-loading-default.gif" data-original="https://cdn.jsdelivr.net/gh/YukiNoUta/cdn-static@main/blog/svg/upyun.svg" width="53" height="18" style="fill:currentColor;display:inline-block"></a></span><span class="post-meta-divider">|</span>今早雾霾蔽日，但是不要害怕，太阳依旧在云端</div><div class="busuanzi-count"><script data-pjax="" async="" src="js/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:inline"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="//unpkg.com/animejs@3.1.0/lib/anime.min.js"></script><script src="//npm.elemecdn.com/pjax/pjax.min.js"></script><script src="//lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="//unpkg.com/lozad@1.16.0/dist/lozad.min.js"></script><script src="//lib.baomitu.com/pangu/4.0.7/pangu.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
    $(document).ready(function () {

    if(location.href.indexOf("#reloaded")==-1){
        location.href=location.href+"#reloaded";
        location.reload();
    }
}）
#在这后面可以加入程序的其他代码  


  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });

  
  NexT.boot.refresh();
  
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  
  NexT.utils.updateSidebarPosition();
});</script><script defer="" src="//img.yousazoe.top/js/three.min.js"></script><script defer="" src="//img.yousazoe.top/js/caidai.js"></script><script data-pjax="">!function(){var e,t,o,n,r=document.getElementsByTagName("link");if(0<r.length)for(i=0;i<r.length;i++)"canonical"==r[i].rel.toLowerCase()&&r[i].href&&(e=r[i].href);t=(e||window.location.protocol).split(":")[0],e=e||window.location.href,window,o=e,n=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(o)||(t="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",n?(t+="?r="+encodeURIComponent(document.referrer),o&&(t+="&l="+o)):o&&(t+="?l="+o),(new Image).src=t)}()</script><script src="/js/local-search.js"></script><script data-pjax="">document.querySelectorAll(".pdfobject-container").forEach(e=>{var t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),r=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${r}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script data-pjax="">document.querySelectorAll("pre.mermaid").length&&NexT.utils.getScript("//lib.baomitu.com/mermaid/8.4.8/mermaid.min.js",()=>{mermaid.initialize({theme:"forest",logLevel:3,flowchart:{curve:"linear"},gantt:{axisFormat:"%m/%d/%Y"},sequence:{actorMargin:50}})},window.mermaid)</script><div id="pjax"></div><script type="text/javascript" src="/js/cursor/fireworks.js"></script><script src="https://img.yousazoe.top/live2dw/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/assets/hijiki.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!0},log:!1})</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:5,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=r[a],t=e,n=function(){r=r.filter(function(t){return e!==t})},i=new Image,o=t.getAttribute("data-original");i.onload=function(){t.src=o,n()},t.src!==o&&(i.src=o)}()}o(),n.addEventListener("scroll",function(){var t=o,e=n;clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script type="text/javascript" charset="utf-8" src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script></body></html>